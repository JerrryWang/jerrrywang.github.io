<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><title>Python之旅：常用模块 | JerryWang</title><meta name="keywords" content="模块"><meta name="author" content="JerryWang"><meta name="copyright" content="JerryWang"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="time与datetime模块在Python中，通常有这几种方式来表示时间：  时间戳(timestamp)：通常来说，时间戳表示的是从1970年1月1日00:00:00开始按秒计算的偏移量。我们运行“type(time.time())”，返回的是float类型。 格式化的时间字符串(Format String) 结构化的时间(struct_time)：struct_time元组共有9个元素共九个"><meta property="og:type" content="article"><meta property="og:title" content="Python之旅：常用模块"><meta property="og:url" content="https://moyand.gitee.io/2019/11/27/Python/Python%E4%B9%8B%E6%97%85/Python%E4%B9%8B%E6%97%85%EF%BC%9A%E5%B8%B8%E7%94%A8%E6%A8%A1%E5%9D%97/index.html"><meta property="og:site_name" content="JerryWang"><meta property="og:description" content="time与datetime模块在Python中，通常有这几种方式来表示时间：  时间戳(timestamp)：通常来说，时间戳表示的是从1970年1月1日00:00:00开始按秒计算的偏移量。我们运行“type(time.time())”，返回的是float类型。 格式化的时间字符串(Format String) 结构化的时间(struct_time)：struct_time元组共有9个元素共九个"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://moyand.gitee.io/2019/11/27/Python/Python之旅/Python之旅：常用模块/top.png"><meta property="article:published_time" content="2019-11-27T08:32:36.000Z"><meta property="article:modified_time" content="2022-09-14T16:06:56.512Z"><meta property="article:author" content="JerryWang"><meta property="article:tag" content="模块"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://moyand.gitee.io/2019/11/27/Python/Python之旅/Python之旅：常用模块/top.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://moyand.gitee.io/2019/11/27/Python/Python%E4%B9%8B%E6%97%85/Python%E4%B9%8B%E6%97%85%EF%BC%9A%E5%B8%B8%E7%94%A8%E6%A8%A1%E5%9D%97/"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://jerrrywang.github.io/api/shubiao/Cyan.ttf" media="print" onload='this.media="all"'><script>const GLOBAL_CONFIG={root:"/",algolia:{appId:"NL6QRV8F8M",apiKey:"0b99ef5723aa77799f47331a0e3bc4ff",indexName:"my-blog",hits:{per_page:6},languages:{input_placeholder:"搜索文章",hits_empty:"找不到您查询的内容：${query}",hits_stats:"找到 ${hits} 条结果，用时 ${time} 毫秒"}},localSearch:void 0,translate:void 0,noticeOutdate:{limitDay:30,position:"top",messagePrev:"本文上次更新于",messageNext:"天前，文章内容可能已经过时。"},highlight:{plugin:"highlighjs",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:!1},copy:{success:"复制成功",error:"复制错误",noSupport:"浏览器不支持"},relativeDate:{homepage:!1,post:!0},runtime:"",date_suffix:{just:"刚刚",min:"分钟前",hour:"小时前",day:"天前",month:"个月前"},copyright:{limitCount:50,languages:{author:"作者: JerryWang",link:"链接: ",source:"来源: JerryWang",info:"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},lightbox:"fancybox",Snackbar:{chs_to_cht:"你已切换为繁体",cht_to_chs:"你已切换为简体",day_to_night:"你已切换为深色模式",night_to_day:"你已切换为浅色模式",bgLight:"#49b1f5",bgDark:"#1f1f1f",position:"bottom-left"},source:{justifiedGallery:{js:"https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js",css:"https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css"}},isPhotoFigcaption:!0,islazyload:!1,isAnchor:!0}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"Python之旅：常用模块",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2022-09-15 00:06:56"}</script><noscript><style>#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(e=>{e.saveToLocal={set:function(e,t,o){if(0===o)return;const a=864e5*o,n={value:t,expiry:(new Date).getTime()+a};localStorage.setItem(e,JSON.stringify(n))},get:function(e){const t=localStorage.getItem(e);if(!t)return;const o=JSON.parse(t);if(!((new Date).getTime()>o.expiry))return o.value;localStorage.removeItem(e)}},e.getScript=e=>new Promise((t,o)=>{const a=document.createElement("script");a.src=e,a.async=!0,a.onerror=o,a.onload=a.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(a.onload=a.onreadystatechange=null,t())},document.head.appendChild(a)}),e.activateDarkMode=function(){document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#0d0d0d")},e.activateLightMode=function(){document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#ffffff")};const t=saveToLocal.get("theme"),o=(new Date).getHours();void 0===t?o<=6||o>=18?activateDarkMode():activateLightMode():"light"===t?activateLightMode():activateDarkMode();const a=saveToLocal.get("aside-status");void 0!==a&&("hide"===a?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside"));/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})(window)</script><script src="https://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script><script src="/js/welcome.js"></script><script src="/js/sweetalert.js"></script><script src="/api/shubiao/sakuraDrops.js"></script><link rel="stylesheet" href="/css/sweetalert.css"><style>#toggle-sidebar{left:100px}</style><link rel="stylesheet" href="/css/custom.css" media="defer" onload='this.media="all"'><link rel="stylesheet" href="https://moyand.gitee.io/api/npm/hexo-electric-clock-plus/clock.css"><meta name="generator" content="Hexo 6.2.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/avatar.png" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">130</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">88</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">26</div></a></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i> <span>时光轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i> <span>标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i> <span>分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-coffee"></i> <span>留言板</span></a></div><div class="menus_item"><a class="site-page" href="/gallery/"><i class="fa-fw fas fa-bicycle"></i> <span>相册</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i> <span>友链</span></a></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fas fa-heartbeat"></i> <span>关于</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-motorcycle"></i> <span>清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/games/"><i class="fa-fw fas fa-gamepad"></i> <span>游戏</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-film"></i> <span>电影</span></a></li><li><a class="site-page child" href="/books/"><i class="fa-fw fas fa-book"></i> <span>书籍</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image:url(https://moyand.gitee.io/2019/11/27/Python/Python之旅/Python之旅：常用模块/top.png)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">JerryWang</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i> <span>搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i> <span>时光轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i> <span>标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i> <span>分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-coffee"></i> <span>留言板</span></a></div><div class="menus_item"><a class="site-page" href="/gallery/"><i class="fa-fw fas fa-bicycle"></i> <span>相册</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i> <span>友链</span></a></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fas fa-heartbeat"></i> <span>关于</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-motorcycle"></i> <span>清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/games/"><i class="fa-fw fas fa-gamepad"></i> <span>游戏</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-film"></i> <span>电影</span></a></li><li><a class="site-page child" href="/books/"><i class="fa-fw fas fa-book"></i> <span>书籍</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Python之旅：常用模块</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2019-11-27T08:32:36.000Z" title="发表于 2019-11-27 16:32:36">2019-11-27</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-09-14T16:06:56.512Z" title="更新于 2022-09-15 00:06:56">2022-09-15</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Python%E4%B9%8B%E6%97%85/">Python之旅</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">14.3k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>65分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" data-flag-title="Python之旅：常用模块"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="time与datetime模块"><a href="#time与datetime模块" class="headerlink" title="time与datetime模块"></a>time与datetime模块</h1><p>在Python中，通常有这几种方式来表示时间：</p><ul><li>时间戳(timestamp)：通常来说，时间戳表示的是从1970年1月1日00:00:00开始按秒计算的偏移量。我们运行“type(time.time())”，返回的是float类型。</li><li>格式化的时间字符串(Format String)</li><li>结构化的时间(struct_time)：struct_time元组共有9个元素共九个元素:(年，月，日，时，分，秒，一年中第几周，一年中第几天，夏令时)</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="comment">#--------------------------我们先以当前时间为准,让大家快速认识三种形式的时间</span></span><br><span class="line"><span class="built_in">print</span>(time.time()) <span class="comment"># 时间戳:1487130156.419527</span></span><br><span class="line"><span class="built_in">print</span>(time.strftime(<span class="string">&quot;%Y-%m-%d %X&quot;</span>)) <span class="comment">#格式化的时间字符串:&#x27;2017-02-15 11:40:53&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(time.localtime()) <span class="comment">#本地时区的struct_time</span></span><br><span class="line"><span class="built_in">print</span>(time.gmtime())    <span class="comment">#UTC时区的struct_time</span></span><br></pre></td></tr></table></figure><p>格式化字符串的时间格式 ：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">%a    Locale’s abbreviated weekday name.     </span><br><span class="line">%A    Locale’s full weekday name.     </span><br><span class="line">%b    Locale’s abbreviated month name.     </span><br><span class="line">%B    Locale’s full month name.     </span><br><span class="line">%c    Locale’s appropriate date <span class="keyword">and</span> time representation.     </span><br><span class="line">%d    Day of the month <span class="keyword">as</span> a decimal number [01,<span class="number">31</span>].     </span><br><span class="line">%H    Hour (<span class="number">24</span>-hour clock) <span class="keyword">as</span> a decimal number [<span class="number">00</span>,<span class="number">23</span>].     </span><br><span class="line">%I    Hour (<span class="number">12</span>-hour clock) <span class="keyword">as</span> a decimal number [01,<span class="number">12</span>].     </span><br><span class="line">%j    Day of the year <span class="keyword">as</span> a decimal number [001,<span class="number">366</span>].     </span><br><span class="line">%m    Month <span class="keyword">as</span> a decimal number [01,<span class="number">12</span>].     </span><br><span class="line">%M    Minute <span class="keyword">as</span> a decimal number [<span class="number">00</span>,<span class="number">59</span>].     </span><br><span class="line">%p    Locale’s equivalent of either AM <span class="keyword">or</span> PM.    (<span class="number">1</span>)</span><br><span class="line">%S    Second <span class="keyword">as</span> a decimal number [<span class="number">00</span>,<span class="number">61</span>].    (<span class="number">2</span>)</span><br><span class="line">%U    Week number of the year (Sunday <span class="keyword">as</span> the first day of the week) <span class="keyword">as</span> a decimal number [<span class="number">00</span>,<span class="number">53</span>]. All days <span class="keyword">in</span> a new year preceding the first Sunday are considered to be <span class="keyword">in</span> week <span class="number">0.</span>    (<span class="number">3</span>)</span><br><span class="line">%w    Weekday <span class="keyword">as</span> a decimal number [<span class="number">0</span>(Sunday),<span class="number">6</span>].     </span><br><span class="line">%W    Week number of the year (Monday <span class="keyword">as</span> the first day of the week) <span class="keyword">as</span> a decimal number [<span class="number">00</span>,<span class="number">53</span>]. All days <span class="keyword">in</span> a new year preceding the first Monday are considered to be <span class="keyword">in</span> week <span class="number">0.</span>    (<span class="number">3</span>)</span><br><span class="line">%x    Locale’s appropriate date representation.     </span><br><span class="line">%X    Locale’s appropriate time representation.     </span><br><span class="line">%y    Year without century <span class="keyword">as</span> a decimal number [<span class="number">00</span>,<span class="number">99</span>].     </span><br><span class="line">%Y    Year <span class="keyword">with</span> century <span class="keyword">as</span> a decimal number.     </span><br><span class="line">%z    Time zone offset indicating a positive <span class="keyword">or</span> negative time difference <span class="keyword">from</span> UTC/GMT of the form +HHMM <span class="keyword">or</span> -HHMM, where H represents decimal hour digits <span class="keyword">and</span> M represents decimal minute digits [-<span class="number">23</span>:<span class="number">59</span>, +<span class="number">23</span>:<span class="number">59</span>].     </span><br><span class="line">%Z    Time zone name (no characters <span class="keyword">if</span> no time zone exists).     </span><br><span class="line">%%    A literal <span class="string">&#x27;%&#x27;</span> character.</span><br></pre></td></tr></table></figure><p>其中计算机认识的时间只能是’时间戳’格式，而程序员可处理的或者说人类能看懂的时间有: ‘格式化的时间字符串’，’结构化的时间’ ，于是有了下图的转换关系</p><p><img src="1036857-20170215142700722-743334012.png" alt="img"><br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#--------------------------按图1转换时间</span></span><br><span class="line"><span class="comment"># localtime([secs])</span></span><br><span class="line"><span class="comment"># 将一个时间戳转换为当前时区的struct_time。secs参数未提供，则以当前时间为准。</span></span><br><span class="line">time.localtime()</span><br><span class="line">time.localtime(<span class="number">1473525444.037215</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># gmtime([secs]) 和localtime()方法类似，gmtime()方法是将一个时间戳转换为UTC时区（0时区）的struct_time。</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># mktime(t) : 将一个struct_time转化为时间戳。</span></span><br><span class="line"><span class="built_in">print</span>(time.mktime(time.localtime()))<span class="comment">#1473525749.0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># strftime(format[, t]) : 把一个代表时间的元组或者struct_time（如由time.localtime()和</span></span><br><span class="line"><span class="comment"># time.gmtime()返回）转化为格式化的时间字符串。如果t未指定，将传入time.localtime()。如果元组中任何一个</span></span><br><span class="line"><span class="comment"># 元素越界，ValueError的错误将会被抛出。</span></span><br><span class="line"><span class="built_in">print</span>(time.strftime(<span class="string">&quot;%Y-%m-%d %X&quot;</span>, time.localtime()))<span class="comment">#2016-09-11 00:49:56</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># time.strptime(string[, format])</span></span><br><span class="line"><span class="comment"># 把一个格式化时间字符串转化为struct_time。实际上它和strftime()是逆操作。</span></span><br><span class="line"><span class="built_in">print</span>(time.strptime(<span class="string">&#x27;2011-05-05 16:37:06&#x27;</span>, <span class="string">&#x27;%Y-%m-%d %X&#x27;</span>))</span><br><span class="line"><span class="comment">#time.struct_time(tm_year=2011, tm_mon=5, tm_mday=5, tm_hour=16, tm_min=37, tm_sec=6,</span></span><br><span class="line"><span class="comment">#  tm_wday=3, tm_yday=125, tm_isdst=-1)</span></span><br><span class="line"><span class="comment">#在这个函数中，format默认为：&quot;%a %b %d %H:%M:%S %Y&quot;。</span></span><br></pre></td></tr></table></figure><p></p><p><img src="1036857-20170215143428754-2105818567.png" alt="img"><br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#--------------------------按图2转换时间</span></span><br><span class="line"><span class="comment"># asctime([t]) : 把一个表示时间的元组或者struct_time表示为这种形式：&#x27;Sun Jun 20 23:21:05 1993&#x27;。</span></span><br><span class="line"><span class="comment"># 如果没有参数，将会将time.localtime()作为参数传入。</span></span><br><span class="line"><span class="built_in">print</span>(time.asctime())<span class="comment">#Sun Sep 11 00:43:43 2016</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ctime([secs]) : 把一个时间戳（按秒计算的浮点数）转化为time.asctime()的形式。如果参数未给或者为</span></span><br><span class="line"><span class="comment"># None的时候，将会默认time.time()为参数。它的作用相当于time.asctime(time.localtime(secs))。</span></span><br><span class="line"><span class="built_in">print</span>(time.ctime())  <span class="comment"># Sun Sep 11 00:46:38 2016</span></span><br><span class="line"><span class="built_in">print</span>(time.ctime(time.time()))  <span class="comment"># Sun Sep 11 00:46:38 2016</span></span><br></pre></td></tr></table></figure><p></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#--------------------------其他用法</span></span><br><span class="line"><span class="comment"># sleep(secs)</span></span><br><span class="line"><span class="comment"># 线程推迟指定的时间运行，单位为秒。</span></span><br></pre></td></tr></table></figure><p><code>datetime模块</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#时间加减</span></span><br><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"></span><br><span class="line"><span class="comment"># print(datetime.datetime.now()) #返回 2016-08-19 12:47:03.941925</span></span><br><span class="line"><span class="comment">#print(datetime.date.fromtimestamp(time.time()) )  # 时间戳直接转成日期格式 2016-08-19</span></span><br><span class="line"><span class="comment"># print(datetime.datetime.now() )</span></span><br><span class="line"><span class="comment"># print(datetime.datetime.now() + datetime.timedelta(3)) #当前时间+3天</span></span><br><span class="line"><span class="comment"># print(datetime.datetime.now() + datetime.timedelta(-3)) #当前时间-3天</span></span><br><span class="line"><span class="comment"># print(datetime.datetime.now() + datetime.timedelta(hours=3)) #当前时间+3小时</span></span><br><span class="line"><span class="comment"># print(datetime.datetime.now() + datetime.timedelta(minutes=30)) #当前时间+30分</span></span><br><span class="line"><span class="comment"># 指定时间的前一天</span></span><br><span class="line"><span class="built_in">print</span>((datetime.datetime.strptime(<span class="string">&#x27;20160311&#x27;</span>,<span class="string">&quot;%Y%m%d&quot;</span>)+datetime.timedelta(-<span class="number">1</span>)).strftime(<span class="string">&#x27;%Y%m%d&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># c_time  = datetime.datetime.now()</span></span><br><span class="line"><span class="comment"># print(c_time.replace(minute=3,hour=2)) #时间替换</span></span><br></pre></td></tr></table></figure><h1 id="random模块"><a href="#random模块" class="headerlink" title="random模块"></a>random模块</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"> </span><br><span class="line"><span class="built_in">print</span>(random.random())<span class="comment">#(0,1)----float    大于0且小于1之间的小数</span></span><br><span class="line"> </span><br><span class="line"><span class="built_in">print</span>(random.randint(<span class="number">1</span>,<span class="number">3</span>))  <span class="comment">#[1,3]    大于等于1且小于等于3之间的整数</span></span><br><span class="line"> </span><br><span class="line"><span class="built_in">print</span>(random.randrange(<span class="number">1</span>,<span class="number">3</span>)) <span class="comment">#[1,3)    大于等于1且小于3之间的整数</span></span><br><span class="line"> </span><br><span class="line"><span class="built_in">print</span>(random.choice([<span class="number">1</span>,<span class="string">&#x27;23&#x27;</span>,[<span class="number">4</span>,<span class="number">5</span>]]))<span class="comment">#1或者23或者[4,5]</span></span><br><span class="line"> </span><br><span class="line"><span class="built_in">print</span>(random.sample([<span class="number">1</span>,<span class="string">&#x27;23&#x27;</span>,[<span class="number">4</span>,<span class="number">5</span>]],<span class="number">2</span>))<span class="comment">#列表元素任意2个组合</span></span><br><span class="line"> </span><br><span class="line"><span class="built_in">print</span>(random.uniform(<span class="number">1</span>,<span class="number">3</span>))<span class="comment">#大于1小于3的小数，如1.927109612082716 </span></span><br><span class="line"></span><br><span class="line">item=[<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">9</span>]</span><br><span class="line">random.shuffle(item) <span class="comment">#打乱item的顺序,相当于&quot;洗牌&quot;</span></span><br><span class="line"><span class="built_in">print</span>(item)</span><br></pre></td></tr></table></figure><p><code>生成随机验证码</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">make_code</span>(<span class="params">n</span>):</span><br><span class="line">    res=<span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        s1=<span class="built_in">chr</span>(random.randint(<span class="number">65</span>,<span class="number">90</span>))</span><br><span class="line">        s2=<span class="built_in">str</span>(random.randint(<span class="number">0</span>,<span class="number">9</span>))</span><br><span class="line">        res+=random.choice([s1,s2])</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(make_code(<span class="number">9</span>))</span><br></pre></td></tr></table></figure><h1 id="os模块"><a href="#os模块" class="headerlink" title="os模块"></a>os模块</h1><p>os模块是与操作系统交互的一个接口</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">os.getcwd() 获取当前工作目录，即当前python脚本工作的目录路径</span><br><span class="line">os.chdir(<span class="string">&quot;dirname&quot;</span>)  改变当前脚本工作目录；相当于shell下cd</span><br><span class="line">os.curdir  返回当前目录: (<span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">os.pardir  获取当前目录的父目录字符串名：(<span class="string">&#x27;..&#x27;</span>)</span><br><span class="line">os.makedirs(<span class="string">&#x27;dirname1/dirname2&#x27;</span>)    可生成多层递归目录</span><br><span class="line">os.removedirs(<span class="string">&#x27;dirname1&#x27;</span>)    若目录为空，则删除，并递归到上一级目录，如若也为空，则删除，依此类推</span><br><span class="line">os.mkdir(<span class="string">&#x27;dirname&#x27;</span>)    生成单级目录；相当于shell中mkdir dirname</span><br><span class="line">os.rmdir(<span class="string">&#x27;dirname&#x27;</span>)    删除单级空目录，若目录不为空则无法删除，报错；相当于shell中rmdir dirname</span><br><span class="line">os.listdir(<span class="string">&#x27;dirname&#x27;</span>)    列出指定目录下的所有文件和子目录，包括隐藏文件，并以列表方式打印</span><br><span class="line">os.remove()  删除一个文件</span><br><span class="line">os.rename(<span class="string">&quot;oldname&quot;</span>,<span class="string">&quot;newname&quot;</span>)  重命名文件/目录</span><br><span class="line">os.stat(<span class="string">&#x27;path/filename&#x27;</span>)  获取文件/目录信息</span><br><span class="line">os.sep    输出操作系统特定的路径分隔符，win下为<span class="string">&quot;\\&quot;</span>,Linux下为<span class="string">&quot;/&quot;</span></span><br><span class="line">os.linesep    输出当前平台使用的行终止符，win下为<span class="string">&quot;\t\n&quot;</span>,Linux下为<span class="string">&quot;\n&quot;</span></span><br><span class="line">os.pathsep    输出用于分割文件路径的字符串 win下为;,Linux下为:</span><br><span class="line">os.name    输出字符串指示当前使用平台。win-&gt;<span class="string">&#x27;nt&#x27;</span>; Linux-&gt;<span class="string">&#x27;posix&#x27;</span></span><br><span class="line">os.system(<span class="string">&quot;bash command&quot;</span>)  运行shell命令，直接显示</span><br><span class="line">os.popen(command[, mode[, bufsize]]) </span><br><span class="line">    command -- 使用的命令。</span><br><span class="line">    mode -- 模式权限可以是 <span class="string">&#x27;r&#x27;</span>(默认) 或 <span class="string">&#x27;w&#x27;</span>。</span><br><span class="line">    bufsize -- 指明了文件需要的缓冲大小：<span class="number">0</span>意味着无缓冲；<span class="number">1</span>意味着行缓冲；其它正值表示使用参数大小的缓冲（大概值，以字节为单位）。负的bufsize意味着使用系统的默认值，一般来说，对于tty设备，它是行缓冲；对于其它文件，它是全缓冲。如果没有改参数，使用系统的默认值。</span><br><span class="line">os.environ  获取系统环境变量</span><br><span class="line">os.path.abspath(path)  返回path规范化的绝对路径</span><br><span class="line">os.path.split(path)  将path分割成目录和文件名二元组返回</span><br><span class="line">os.path.dirname(path)  返回path的目录。其实就是os.path.split(path)的第一个元素</span><br><span class="line">os.path.basename(path)  返回path最后的文件名。如何path以／或\结尾，那么就会返回空值。即os.path.split(path)的第二个元素</span><br><span class="line">os.path.exists(path)  如果path存在，返回<span class="literal">True</span>；如果path不存在，返回<span class="literal">False</span></span><br><span class="line">os.path.isabs(path)  如果path是绝对路径，返回<span class="literal">True</span></span><br><span class="line">os.path.isfile(path)  如果path是一个存在的文件，返回<span class="literal">True</span>。否则返回<span class="literal">False</span></span><br><span class="line">os.path.isdir(path)  如果path是一个存在的目录，则返回<span class="literal">True</span>。否则返回<span class="literal">False</span></span><br><span class="line">os.path.join(path1[, path2[, ...]])  将多个路径组合后返回，第一个绝对路径之前的参数将被忽略</span><br><span class="line">os.path.getatime(path)  返回path所指向的文件或者目录的最后存取时间</span><br><span class="line">os.path.getmtime(path)  返回path所指向的文件或者目录的最后修改时间</span><br><span class="line">os.path.getsize(path) 返回path的大小</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">在Linux和Mac平台上，该函数会原样返回path，在windows平台上会将路径中所有字符转换为小写，并将所有斜杠转换为饭斜杠。</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>os.path.normcase(<span class="string">&#x27;c:/windows\\system32\\&#x27;</span>)   </span><br><span class="line"><span class="string">&#x27;c:\\windows\\system32\\&#x27;</span>   </span><br><span class="line">   </span><br><span class="line"></span><br><span class="line">规范化路径，如..和/</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>os.path.normpath(<span class="string">&#x27;c://windows\\System32\\../Temp/&#x27;</span>)   </span><br><span class="line"><span class="string">&#x27;c:\\windows\\Temp&#x27;</span>   </span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a=<span class="string">&#x27;/Users/jieli/test1/\\\a1/\\\\aa.py/../..&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(os.path.normpath(a))</span><br><span class="line">/Users/jieli/test1</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">os路径处理</span><br><span class="line"><span class="comment">#方式一：</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="comment">#具体应用</span></span><br><span class="line"><span class="keyword">import</span> os,sys</span><br><span class="line">possible_topdir = os.path.normpath(os.path.join(</span><br><span class="line">    os.path.abspath(__file__),</span><br><span class="line">    os.pardir, <span class="comment">#上一级</span></span><br><span class="line">    os.pardir,</span><br><span class="line">    os.pardir</span><br><span class="line">))</span><br><span class="line">sys.path.insert(<span class="number">0</span>,possible_topdir)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#方式二：</span></span><br><span class="line">os.path.dirname(os.path.dirname(os.path.dirname(os.path.abspath(__file__))))</span><br></pre></td></tr></table></figure><h2 id="python调用Shell脚本"><a href="#python调用Shell脚本" class="headerlink" title="python调用Shell脚本"></a>python调用Shell脚本</h2><p>有两种方法：os.system()和os.popen()</p><p>前者返回值是脚本的退出状态码，后者的返回值是脚本执行过程中的输出内容</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> os</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s=os.system(<span class="string">&quot;ls&quot;</span>) <span class="comment"># 直接看到运行结果</span></span><br><span class="line">home  lost+found  mysql  py36.tgz  py.tgz  release  scripts  server.tgz  swapfile1  test3  web</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s <span class="comment"># 返回值为0,表示命令执行成功;非0即不成功</span></span><br><span class="line"><span class="number">0</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>p=os.popen(<span class="string">&quot;ls&quot;</span>)  <span class="comment"># 返回一个file对象，可以对这个文件对象进行相关的操作</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>p</span><br><span class="line">&lt;os._wrap_close <span class="built_in">object</span> at <span class="number">0x2b31da178710</span>&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>p.readlines()</span><br><span class="line">[<span class="string">&#x27;home\n&#x27;</span>, <span class="string">&#x27;lost+found\n&#x27;</span>, <span class="string">&#x27;mysql\n&#x27;</span>, <span class="string">&#x27;py36.tgz\n&#x27;</span>, <span class="string">&#x27;py.tgz\n&#x27;</span>, <span class="string">&#x27;release\n&#x27;</span>, <span class="string">&#x27;scripts\n&#x27;</span>, <span class="string">&#x27;server.tgz\n&#x27;</span>, <span class="string">&#x27;swapfile1\n&#x27;</span>, <span class="string">&#x27;test3\n&#x27;</span>, <span class="string">&#x27;web\n&#x27;</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>p.read() <span class="comment"># 既然是文件对象，使用完就应该关闭,所以为空了</span></span><br><span class="line"><span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>p=os.popen(<span class="string">&quot;ls&quot;</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>p.read()</span><br><span class="line"><span class="string">&#x27;home\nlost+found\nmysql\npy36.tgz\npy.tgz\nrelease\nscripts\nserver.tgz\nswapfile1\ntest3\nweb\n&#x27;</span></span><br></pre></td></tr></table></figure><p>os.popen()可以实现一个“管道”，从这个命令获取的值可以继续被使用。因为它返回一个文件对象，可以对这个文件对象进行相关的操作。</p><p>os.popen()知识点梳理:</p><ol><li><p>注意：<strong>返回值是文件对象</strong>，既然是文件对象，使用完就应该关闭！网上搜一下，一大把文章提到这个os.popen都是忘记关闭文件对象的。 所以，推荐的写法是：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">with os.popen(command, &quot;r&quot;) as p:</span><br><span class="line">    r = p.read()</span><br></pre></td></tr></table></figure></li><li><p>非阻塞</p><p>通俗的讲，非阻塞就是os.popen不会等cmd命令执行完毕就继续下面的代码了.</p><p>那如何让命令执行完后，再执行下一句呢？</p><p>处理方法是使用read()或readlines()对命令的执行结果进行读操作。</p></li><li><p>完全阻塞</p><p>上面写了该函数是非阻塞的，现在怎么又变成完全阻塞的呢？感觉一头雾水了吧。本质上os.popen是非阻塞的，为了实现阻塞的效果，我们使用read()或readlines()对命令结果进行读，由此产生了阻塞的效果。但是，如果你的命令执行无法退出或进入交互模式，这种“读”将形成完全阻塞的情况，表现的像程序卡住了。</p><p>看下面代码实例1：</p></li></ol><p><img src="image-20200229161849113.png" alt="img"><br>os.popen执行了ping 127.0.0.1 -t 该命令会一直执行，除非CTRL+C强制退出，因而，执行readlines读取命令输出时会造成卡住。</p><p>代码实例2：</p><p>使用os.popen执行sqlplus命令对数据库进行操作的场景，如果sqlplus执行失败，会进入交互模式，如图所示，此时使用readlines()读取执行结果时也会卡死，效果如上图：<br><img src="image-20200229161936251.png" alt="img"><br>总结</p><p>os.popen()在大多数场景都是挺好用方便的，但是也有坑！！ 具体应用中，需要注意下。</p><p>建议：</p><ol><li>在需要读取命令执行结果时，避免在命令无法退出或进入交互模式的场景应用os.popen;</li><li><p>os.popen()无法满足需求时，可以考虑subprocess.Popen();</p><p><a target="_blank" rel="noopener" href="http://wangjieyu.cn/2020/01/07/Python/%E5%A5%87%E9%97%BB%E6%9D%82%E8%B0%88/subprocess%E6%A8%A1%E5%9D%97/">http://wangjieyu.cn/2020/01/07/Python/%E5%A5%87%E9%97%BB%E6%9D%82%E8%B0%88/subprocess%E6%A8%A1%E5%9D%97/</a></p><p><a href="http://moyand.gitee.io//2020/01/07/Python/%E5%A5%87%E9%97%BB%E6%9D%82%E8%B0%88/subprocess%E6%A8%A1%E5%9D%97/">http://moyand.gitee.io//2020/01/07/Python/%E5%A5%87%E9%97%BB%E6%9D%82%E8%B0%88/subprocess%E6%A8%A1%E5%9D%97/</a></p></li></ol><h1 id="sys模块"><a href="#sys模块" class="headerlink" title="sys模块"></a>sys模块</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sys.argv           命令行参数<span class="type">List</span>，第一个元素是程序本身路径</span><br><span class="line">sys.exit(n)        退出程序，正常退出时exit(<span class="number">0</span>)</span><br><span class="line">sys.version        获取Python解释程序的版本信息</span><br><span class="line">sys.maxint         最大的Int值</span><br><span class="line">sys.path           返回模块的搜索路径，初始化时使用PYTHONPATH环境变量的值</span><br><span class="line">sys.platform       返回操作系统平台名称</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#=========知识储备==========</span></span><br><span class="line"><span class="comment">#进度条的效果</span></span><br><span class="line">[<span class="comment">#             ]</span></span><br><span class="line">[<span class="comment">##            ]</span></span><br><span class="line">[<span class="comment">###           ]</span></span><br><span class="line">[<span class="comment">####          ]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#指定宽度</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;[%-15s]&#x27;</span> %<span class="string">&#x27;#&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;[%-15s]&#x27;</span> %<span class="string">&#x27;##&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;[%-15s]&#x27;</span> %<span class="string">&#x27;###&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;[%-15s]&#x27;</span> %<span class="string">&#x27;####&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#打印%</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;%s%%&#x27;</span> %(<span class="number">100</span>)) <span class="comment">#第二个%号代表取消第一个%的特殊意义</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#可传参来控制宽度</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;[%%-%ds]&#x27;</span> %<span class="number">50</span>) <span class="comment">#[%-50s]</span></span><br><span class="line"><span class="built_in">print</span>((<span class="string">&#x27;[%%-%ds]&#x27;</span> %<span class="number">50</span>) %<span class="string">&#x27;#&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>((<span class="string">&#x27;[%%-%ds]&#x27;</span> %<span class="number">50</span>) %<span class="string">&#x27;##&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>((<span class="string">&#x27;[%%-%ds]&#x27;</span> %<span class="number">50</span>) %<span class="string">&#x27;###&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#=========实现打印进度条函数==========</span></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">progress</span>(<span class="params">percent,width=<span class="number">50</span></span>):</span><br><span class="line">    <span class="keyword">if</span> percent &gt;= <span class="number">1</span>:</span><br><span class="line">        percent=<span class="number">1</span></span><br><span class="line">    show_str=(<span class="string">&#x27;[%%-%ds]&#x27;</span> %width) %(<span class="built_in">int</span>(width*percent)*<span class="string">&#x27;#&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;\r%s %d%%&#x27;</span> %(show_str,<span class="built_in">int</span>(<span class="number">100</span>*percent)),file=sys.stdout,flush=<span class="literal">True</span>,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#=========应用==========</span></span><br><span class="line">data_size=<span class="number">1025</span></span><br><span class="line">recv_size=<span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> recv_size &lt; data_size:</span><br><span class="line">    time.sleep(<span class="number">0.1</span>) <span class="comment">#模拟数据的传输延迟</span></span><br><span class="line">    recv_size+=<span class="number">1024</span> <span class="comment">#每次收1024</span></span><br><span class="line"></span><br><span class="line">    percent=recv_size/data_size <span class="comment">#接收的比例</span></span><br><span class="line">    progress(percent,width=<span class="number">70</span>) <span class="comment">#进度条的宽度70</span></span><br></pre></td></tr></table></figure><h1 id="shutil模块"><a href="#shutil模块" class="headerlink" title="shutil模块"></a>shutil模块</h1><p>高级的 文件、文件夹、压缩包 处理模块</p><p><code>shutil.copyfileobj(fsrc, fdst[, length])</code></p><p>将文件内容拷贝到另一个文件中</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> shutil</span><br><span class="line"> </span><br><span class="line">shutil.copyfileobj(<span class="built_in">open</span>(<span class="string">&#x27;old.xml&#x27;</span>,<span class="string">&#x27;r&#x27;</span>), <span class="built_in">open</span>(<span class="string">&#x27;new.xml&#x27;</span>, <span class="string">&#x27;w&#x27;</span>))</span><br></pre></td></tr></table></figure><p><code>shutil.copyfile(src, dst)</code></p><p>拷贝文件</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shutil.copyfile(<span class="string">&#x27;f1.log&#x27;</span>, <span class="string">&#x27;f2.log&#x27;</span>) <span class="comment">#目标文件无需存在</span></span><br></pre></td></tr></table></figure><p><code>shutil.copymode(src, dst)</code></p><p>仅拷贝权限。内容、组、用户均不变</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shutil.copymode(<span class="string">&#x27;f1.log&#x27;</span>, <span class="string">&#x27;f2.log&#x27;</span>) <span class="comment">#目标文件必须存在</span></span><br></pre></td></tr></table></figure><p><code>shutil.copystat(src, dst)</code></p><p>仅拷贝状态的信息，包括：mode bits, atime, mtime, flags</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shutil.copystat(<span class="string">&#x27;f1.log&#x27;</span>, <span class="string">&#x27;f2.log&#x27;</span>) <span class="comment">#目标文件必须存在</span></span><br></pre></td></tr></table></figure><p><code>shutil.copy(src, dst)</code></p><p>拷贝文件和权限</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> shutil</span><br><span class="line"> </span><br><span class="line">shutil.copy(<span class="string">&#x27;f1.log&#x27;</span>, <span class="string">&#x27;f2.log&#x27;</span>)</span><br></pre></td></tr></table></figure><p><code>shutil.copy2(src, dst)</code></p><p>拷贝文件和状态信息</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> shutil</span><br><span class="line"> </span><br><span class="line">shutil.copy2(<span class="string">&#x27;f1.log&#x27;</span>, <span class="string">&#x27;f2.log&#x27;</span>)</span><br></pre></td></tr></table></figure><p><code>shutil.ignore_patterns(\*patterns)</code></p><p><code>shutil.copytree(src, dst, symlinks=False, ignore=None)</code></p><p>递归的去拷贝文件夹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> shutil</span><br><span class="line"><span class="comment">#目标目录不能存在，注意对folder2目录父级目录要有可写权限，ignore的意思是排除 </span></span><br><span class="line">shutil.copytree(<span class="string">&#x27;folder1&#x27;</span>, <span class="string">&#x27;folder2&#x27;</span>, ignore=shutil.ignore_patterns(<span class="string">&#x27;*.pyc&#x27;</span>, <span class="string">&#x27;tmp*&#x27;</span>)) </span><br></pre></td></tr></table></figure><p><code>拷贝软连接</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> shutil</span><br><span class="line"></span><br><span class="line">shutil.copytree(<span class="string">&#x27;f1&#x27;</span>, <span class="string">&#x27;f2&#x27;</span>, symlinks=<span class="literal">True</span>, ignore=shutil.ignore_patterns(<span class="string">&#x27;*.pyc&#x27;</span>, <span class="string">&#x27;tmp*&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">通常的拷贝都把软连接拷贝成硬链接，即对待软连接来说，创建新的文件</span></span><br></pre></td></tr></table></figure><p><code>shutil.rmtree(path[, ignore_errors[, onerror]])</code></p><p>递归的去删除文件</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> shutil</span><br><span class="line"> </span><br><span class="line">shutil.rmtree(<span class="string">&#x27;folder1&#x27;</span>)</span><br></pre></td></tr></table></figure><p><code>shutil.move(src, dst)</code></p><p>递归的去移动文件，它类似mv命令，其实就是重命名。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> shutil</span><br><span class="line"> </span><br><span class="line">shutil.move(<span class="string">&#x27;folder1&#x27;</span>, <span class="string">&#x27;folder3&#x27;</span>)</span><br></pre></td></tr></table></figure><p><code>shutil.make_archive(base_name, format,...)</code></p><p>创建压缩包并返回文件路径，例如：zip、tar</p><p>创建压缩包并返回文件路径，例如：zip、tar</p><ul><li>base_name： 压缩包的文件名，也可以是压缩包的路径。只是文件名时，则保存至当前目录，否则保存至指定路径，<br>如 data_bak =&gt;保存至当前路径<br>如：/tmp/data_bak =&gt;保存至/tmp/</li><li>format： 压缩包种类，“zip”, “tar”, “bztar”，“gztar”</li><li>root_dir： 要压缩的文件夹路径（默认当前目录）</li><li>owner： 用户，默认当前用户</li><li>group： 组，默认当前组</li><li>logger： 用于记录日志，通常是logging.Logger对象</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#将 /data 下的文件打包放置当前程序目录</span></span><br><span class="line"><span class="keyword">import</span> shutil</span><br><span class="line">ret = shutil.make_archive(<span class="string">&quot;data_bak&quot;</span>, <span class="string">&#x27;gztar&#x27;</span>, root_dir=<span class="string">&#x27;/data&#x27;</span>)</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="comment">#将 /data下的文件打包放置 /tmp/目录</span></span><br><span class="line"><span class="keyword">import</span> shutil</span><br><span class="line">ret = shutil.make_archive(<span class="string">&quot;/tmp/data_bak&quot;</span>, <span class="string">&#x27;gztar&#x27;</span>, root_dir=<span class="string">&#x27;/data&#x27;</span>) </span><br></pre></td></tr></table></figure><p>shutil 对压缩包的处理是调用 ZipFile 和 TarFile 两个模块来进行的，详细：</p><p><code>zipfile压缩解压缩</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line"></span><br><span class="line"><span class="comment"># 压缩</span></span><br><span class="line">z = zipfile.ZipFile(<span class="string">&#x27;laxi.zip&#x27;</span>, <span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">z.write(<span class="string">&#x27;a.log&#x27;</span>)</span><br><span class="line">z.write(<span class="string">&#x27;data.data&#x27;</span>)</span><br><span class="line">z.close()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 解压</span></span><br><span class="line">z = zipfile.ZipFile(<span class="string">&#x27;laxi.zip&#x27;</span>, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">z.extractall(path=<span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">z.close()</span><br></pre></td></tr></table></figure><p><code>tarfile压缩解压缩</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> tarfile</span><br><span class="line"></span><br><span class="line"><span class="comment"># 压缩</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>t=tarfile.<span class="built_in">open</span>(<span class="string">&#x27;/tmp/allen.tar&#x27;</span>,<span class="string">&#x27;w&#x27;</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>t.add(<span class="string">&#x27;/test1/a.py&#x27;</span>,arcname=<span class="string">&#x27;a.bak&#x27;</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>t.add(<span class="string">&#x27;/test1/b.py&#x27;</span>,arcname=<span class="string">&#x27;b.bak&#x27;</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>t.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 解压</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>t=tarfile.<span class="built_in">open</span>(<span class="string">&#x27;/tmp/allen.tar&#x27;</span>,<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>t.extractall(<span class="string">&#x27;/allen&#x27;</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>t.close()</span><br></pre></td></tr></table></figure><h1 id="json-amp-pickle模块"><a href="#json-amp-pickle模块" class="headerlink" title="json&amp;pickle模块"></a>json&amp;pickle模块</h1><p>之前我们学习过用eval内置方法可以将一个字符串转成python对象，不过，eval方法是有局限性的，对于普通的数据类型，json.loads和eval都能用，但遇到特殊类型的时候，eval就不管用了,所以eval的重点还是通常用来执行一个字符串表达式，并返回表达式的值。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line">x=<span class="string">&quot;[null,true,false,1]&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">eval</span>(x)) <span class="comment">#报错，无法解析null类型，而json就可以</span></span><br><span class="line"><span class="built_in">print</span>(json.loads(x)) </span><br></pre></td></tr></table></figure><h2 id="什么是序列化？"><a href="#什么是序列化？" class="headerlink" title="什么是序列化？"></a>什么是序列化？</h2><p>我们把对象(变量)从内存中变成可存储或传输的过程称之为序列化，在Python中叫pickling，在其他语言中也被称之为serialization，marshalling，flattening等等，都是一个意思。</p><h2 id="为什么要序列化？"><a href="#为什么要序列化？" class="headerlink" title="为什么要序列化？"></a>为什么要序列化？</h2><p>1：持久保存状态</p><p>需知一个软件/程序的执行就在处理一系列状态的变化，在编程语言中，’状态’会以各种各样有结构的数据类型(也可简单的理解为变量)的形式被保存在内存中。</p><p>内存是无法永久保存数据的，当程序运行了一段时间，我们断电或者重启程序，内存中关于这个程序的之前一段时间的数据（有结构）都被清空了。</p><p>在断电或重启程序之前将程序当前内存中所有的数据都保存下来（保存到文件中），以便于下次程序执行能够从文件中载入之前的数据，然后继续执行，这就是序列化。</p><p>具体的来说，你玩使命召唤闯到了第13关，你保存游戏状态，关机走人，下次再玩，还能从上次的位置开始继续闯关。或如，虚拟机状态的挂起等。</p><p>2：跨平台数据交互</p><p>序列化之后，不仅可以把序列化后的内容写入磁盘，还可以通过网络传输到别的机器上，如果收发的双方约定好实用一种序列化的格式，那么便打破了平台/语言差异化带来的限制，实现了跨平台数据交互。</p><p>反过来，把变量内容从序列化的对象重新读到内存里称之为反序列化，即unpickling。</p><p>如何序列化之json和pickle：</p><h2 id="json"><a href="#json" class="headerlink" title="json"></a>json</h2><p>如果我们要在不同的编程语言之间传递对象，就必须把对象序列化为标准格式，比如XML，但更好的方法是序列化为JSON，因为JSON表示出来就是一个字符串，可以被所有语言读取，也可以方便地存储到磁盘或者通过网络传输。JSON不仅是标准格式，并且比XML更快，而且可以直接在Web页面中读取，非常方便。</p><p>JSON表示的对象就是标准的JavaScript语言的对象，JSON和Python内置的数据类型对应如下：</p><p><img src="877318-20160911105642628-530508765.png" alt="img"><br><img src="1036857-20170215162939035-339680318.png" alt="img"><br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"> <span class="number">1</span> <span class="keyword">import</span> json</span><br><span class="line"> <span class="number">2</span>  </span><br><span class="line"> <span class="number">3</span> dic=&#123;<span class="string">&#x27;name&#x27;</span>:<span class="string">&#x27;alvin&#x27;</span>,<span class="string">&#x27;age&#x27;</span>:<span class="number">23</span>,<span class="string">&#x27;sex&#x27;</span>:<span class="string">&#x27;male&#x27;</span>&#125;</span><br><span class="line"> <span class="number">4</span> <span class="built_in">print</span>(<span class="built_in">type</span>(dic))<span class="comment">#&lt;class &#x27;dict&#x27;&gt;</span></span><br><span class="line"> <span class="number">5</span>  </span><br><span class="line"> <span class="number">6</span> j=json.dumps(dic)</span><br><span class="line"> <span class="number">7</span> <span class="built_in">print</span>(<span class="built_in">type</span>(j))<span class="comment">#&lt;class &#x27;str&#x27;&gt;</span></span><br><span class="line"> <span class="number">8</span>  </span><br><span class="line"> <span class="number">9</span>  </span><br><span class="line"><span class="number">10</span> f=<span class="built_in">open</span>(<span class="string">&#x27;序列化对象&#x27;</span>,<span class="string">&#x27;w&#x27;</span>)</span><br><span class="line"><span class="number">11</span> f.write(j)  <span class="comment">#-------------------等价于json.dump(dic,f)</span></span><br><span class="line"><span class="number">12</span> f.close()</span><br><span class="line"><span class="number">13</span> <span class="comment">#-----------------------------反序列化&lt;br&gt;</span></span><br><span class="line"><span class="number">14</span> <span class="keyword">import</span> json</span><br><span class="line"><span class="number">15</span> f=<span class="built_in">open</span>(<span class="string">&#x27;序列化对象&#x27;</span>)</span><br><span class="line"><span class="number">16</span> data=json.loads(f.read())<span class="comment">#  等价于data=json.load(f)</span></span><br></pre></td></tr></table></figure><p></p><p><code>注意点</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="comment">#dct=&quot;&#123;&#x27;1&#x27;:111&#125;&quot;#json 不认单引号</span></span><br><span class="line"><span class="comment">#dct=str(&#123;&quot;1&quot;:111&#125;)#报错,因为生成的数据还是单引号:&#123;&#x27;one&#x27;: 1&#125;</span></span><br><span class="line"></span><br><span class="line">dct=<span class="string">&#x27;&#123;&quot;1&quot;:&quot;111&quot;&#125;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(json.loads(dct))</span><br><span class="line"></span><br><span class="line"><span class="comment">#conclusion:</span></span><br><span class="line"><span class="comment">#        无论数据是怎样创建的，只要满足json格式，就可以json.loads出来,不一定非要dumps的数据才能loads</span></span><br></pre></td></tr></table></figure><h2 id="pickle"><a href="#pickle" class="headerlink" title="pickle"></a>pickle</h2><p><img src="1036857-20170215164644722-1590025858.png" alt="img"><br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"> <span class="number">1</span> <span class="keyword">import</span> pickle</span><br><span class="line"> <span class="number">2</span>  </span><br><span class="line"> <span class="number">3</span> dic=&#123;<span class="string">&#x27;name&#x27;</span>:<span class="string">&#x27;alvin&#x27;</span>,<span class="string">&#x27;age&#x27;</span>:<span class="number">23</span>,<span class="string">&#x27;sex&#x27;</span>:<span class="string">&#x27;male&#x27;</span>&#125;</span><br><span class="line"> <span class="number">4</span>  </span><br><span class="line"> <span class="number">5</span> <span class="built_in">print</span>(<span class="built_in">type</span>(dic))<span class="comment">#&lt;class &#x27;dict&#x27;&gt;</span></span><br><span class="line"> <span class="number">6</span>  </span><br><span class="line"> <span class="number">7</span> j=pickle.dumps(dic)</span><br><span class="line"> <span class="number">8</span> <span class="built_in">print</span>(<span class="built_in">type</span>(j))<span class="comment">#&lt;class &#x27;bytes&#x27;&gt;</span></span><br><span class="line"> <span class="number">9</span>  </span><br><span class="line"><span class="number">10</span>  </span><br><span class="line"><span class="number">11</span> f=<span class="built_in">open</span>(<span class="string">&#x27;序列化对象_pickle&#x27;</span>,<span class="string">&#x27;wb&#x27;</span>)<span class="comment">#注意是w是写入str,wb是写入bytes,j是&#x27;bytes&#x27;</span></span><br><span class="line"><span class="number">12</span> f.write(j)  <span class="comment">#-------------------等价于pickle.dump(dic,f)</span></span><br><span class="line"><span class="number">13</span>  </span><br><span class="line"><span class="number">14</span> f.close()</span><br><span class="line"><span class="number">15</span> <span class="comment">#-------------------------反序列化</span></span><br><span class="line"><span class="number">16</span> <span class="keyword">import</span> pickle</span><br><span class="line"><span class="number">17</span> f=<span class="built_in">open</span>(<span class="string">&#x27;序列化对象_pickle&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>)</span><br><span class="line"><span class="number">18</span>  </span><br><span class="line"><span class="number">19</span> data=pickle.loads(f.read())<span class="comment">#  等价于data=pickle.load(f)</span></span><br><span class="line"><span class="number">20</span>  </span><br><span class="line"><span class="number">21</span>  </span><br><span class="line"><span class="number">22</span> <span class="built_in">print</span>(data[<span class="string">&#x27;age&#x27;</span>])   </span><br></pre></td></tr></table></figure><p></p><p>Pickle的问题和所有其他编程语言特有的序列化问题一样，就是它只能用于Python，并且可能不同版本的Python彼此都不兼容，因此，只能用Pickle保存那些不重要的数据，不能成功地反序列化也没关系。</p><h2 id="json-amp-pickle-的区别"><a href="#json-amp-pickle-的区别" class="headerlink" title="json&amp;pickle 的区别"></a>json&amp;pickle 的区别</h2><ol><li><p>json是可以在不同语言之间交换数据的，而pickle只在python之间使用。</p></li><li><p>json只能序列化最基本的数据类型，而pickle可以序列化所有的数据类型，包括类，函数都可以序列化。</p></li><li><p>json模块和picle模块都有 dumps、dump、loads、load四种方法，而且用法一样。</p></li></ol><h1 id="shelve模块"><a href="#shelve模块" class="headerlink" title="shelve模块"></a>shelve模块</h1><p>shelve模块比pickle模块简单，只有一个open函数，返回类似字典的对象，可读可写;key必须为字符串，而值可以是python所支持的数据类型</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> shelve</span><br><span class="line"></span><br><span class="line">f=shelve.<span class="built_in">open</span>(<span class="string">r&#x27;sheve.txt&#x27;</span>)</span><br><span class="line"><span class="comment"># f[&#x27;stu1_info&#x27;]=&#123;&#x27;name&#x27;:&#x27;allen&#x27;,&#x27;age&#x27;:18,&#x27;hobby&#x27;:[&#x27;piao&#x27;,&#x27;smoking&#x27;,&#x27;drinking&#x27;]&#125;</span></span><br><span class="line"><span class="comment"># f[&#x27;stu2_info&#x27;]=&#123;&#x27;name&#x27;:&#x27;gangdan&#x27;,&#x27;age&#x27;:53&#125;</span></span><br><span class="line"><span class="comment"># f[&#x27;school_info&#x27;]=&#123;&#x27;website&#x27;:&#x27;http://www.pypy.org&#x27;,&#x27;city&#x27;:&#x27;beijing&#x27;&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(f[<span class="string">&#x27;stu1_info&#x27;</span>][<span class="string">&#x27;hobby&#x27;</span>])</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure><h1 id="xml模块"><a href="#xml模块" class="headerlink" title="xml模块"></a>xml模块</h1><p>xml是实现不同语言或程序之间进行数据交换的协议，跟json差不多，但json使用起来更简单，不过，古时候，在json还没诞生的黑暗年代，大家只能选择用xml呀，至今很多传统公司如金融行业的很多系统的接口还主要是xml。</p><p>xml的格式如下，就是通过&lt;&gt;节点来区别数据结构的:</p><p><code>xml数据</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span><br><span class="line">&lt;data&gt;</span><br><span class="line">    &lt;country name=<span class="string">&quot;Liechtenstein&quot;</span>&gt;</span><br><span class="line">        &lt;rank updated=<span class="string">&quot;yes&quot;</span>&gt;<span class="number">2</span>&lt;/rank&gt;</span><br><span class="line">        &lt;year&gt;<span class="number">2008</span>&lt;/year&gt;</span><br><span class="line">        &lt;gdppc&gt;<span class="number">141100</span>&lt;/gdppc&gt;</span><br><span class="line">        &lt;neighbor name=<span class="string">&quot;Austria&quot;</span> direction=<span class="string">&quot;E&quot;</span>/&gt;</span><br><span class="line">        &lt;neighbor name=<span class="string">&quot;Switzerland&quot;</span> direction=<span class="string">&quot;W&quot;</span>/&gt;</span><br><span class="line">    &lt;/country&gt;</span><br><span class="line">    &lt;country name=<span class="string">&quot;Singapore&quot;</span>&gt;</span><br><span class="line">        &lt;rank updated=<span class="string">&quot;yes&quot;</span>&gt;<span class="number">5</span>&lt;/rank&gt;</span><br><span class="line">        &lt;year&gt;<span class="number">2011</span>&lt;/year&gt;</span><br><span class="line">        &lt;gdppc&gt;<span class="number">59900</span>&lt;/gdppc&gt;</span><br><span class="line">        &lt;neighbor name=<span class="string">&quot;Malaysia&quot;</span> direction=<span class="string">&quot;N&quot;</span>/&gt;</span><br><span class="line">    &lt;/country&gt;</span><br><span class="line">    &lt;country name=<span class="string">&quot;Panama&quot;</span>&gt;</span><br><span class="line">        &lt;rank updated=<span class="string">&quot;yes&quot;</span>&gt;<span class="number">69</span>&lt;/rank&gt;</span><br><span class="line">        &lt;year&gt;<span class="number">2011</span>&lt;/year&gt;</span><br><span class="line">        &lt;gdppc&gt;<span class="number">13600</span>&lt;/gdppc&gt;</span><br><span class="line">        &lt;neighbor name=<span class="string">&quot;Costa Rica&quot;</span> direction=<span class="string">&quot;W&quot;</span>/&gt;</span><br><span class="line">        &lt;neighbor name=<span class="string">&quot;Colombia&quot;</span> direction=<span class="string">&quot;E&quot;</span>/&gt;</span><br><span class="line">    &lt;/country&gt;</span><br><span class="line">&lt;/data&gt;</span><br></pre></td></tr></table></figure><p>xml协议在各个语言里的都 是支持的，在python中可以用以下模块操作xml：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># print(root.iter(&#x27;year&#x27;)) #全文搜索</span></span><br><span class="line"><span class="comment"># print(root.find(&#x27;country&#x27;)) #在root的子节点找，只找一个</span></span><br><span class="line"><span class="comment"># print(root.findall(&#x27;country&#x27;)) #在root的子节点找，找所有</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> xml.etree.ElementTree <span class="keyword">as</span> ET</span><br><span class="line"> </span><br><span class="line">tree = ET.parse(<span class="string">&quot;xmltest.xml&quot;</span>)</span><br><span class="line">root = tree.getroot()</span><br><span class="line"><span class="built_in">print</span>(root.tag)</span><br><span class="line"> </span><br><span class="line"><span class="comment">#遍历xml文档</span></span><br><span class="line"><span class="keyword">for</span> child <span class="keyword">in</span> root:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;========&gt;&#x27;</span>,child.tag,child.attrib,child.attrib[<span class="string">&#x27;name&#x27;</span>])</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> child:</span><br><span class="line">        <span class="built_in">print</span>(i.tag,i.attrib,i.text)</span><br><span class="line"> </span><br><span class="line"><span class="comment">#只遍历year 节点</span></span><br><span class="line"><span class="keyword">for</span> node <span class="keyword">in</span> root.<span class="built_in">iter</span>(<span class="string">&#x27;year&#x27;</span>):</span><br><span class="line">    <span class="built_in">print</span>(node.tag,node.text)</span><br><span class="line"><span class="comment">#---------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> xml.etree.ElementTree <span class="keyword">as</span> ET</span><br><span class="line"> </span><br><span class="line">tree = ET.parse(<span class="string">&quot;xmltest.xml&quot;</span>)</span><br><span class="line">root = tree.getroot()</span><br><span class="line"> </span><br><span class="line"><span class="comment">#修改</span></span><br><span class="line"><span class="keyword">for</span> node <span class="keyword">in</span> root.<span class="built_in">iter</span>(<span class="string">&#x27;year&#x27;</span>):</span><br><span class="line">    new_year=<span class="built_in">int</span>(node.text)+<span class="number">1</span></span><br><span class="line">    node.text=<span class="built_in">str</span>(new_year)</span><br><span class="line">    node.<span class="built_in">set</span>(<span class="string">&#x27;updated&#x27;</span>,<span class="string">&#x27;yes&#x27;</span>)</span><br><span class="line">    node.<span class="built_in">set</span>(<span class="string">&#x27;version&#x27;</span>,<span class="string">&#x27;1.0&#x27;</span>)</span><br><span class="line">tree.write(<span class="string">&#x27;test.xml&#x27;</span>)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment">#删除node</span></span><br><span class="line"><span class="keyword">for</span> country <span class="keyword">in</span> root.findall(<span class="string">&#x27;country&#x27;</span>):</span><br><span class="line">   rank = <span class="built_in">int</span>(country.find(<span class="string">&#x27;rank&#x27;</span>).text)</span><br><span class="line">   <span class="keyword">if</span> rank &gt; <span class="number">50</span>:</span><br><span class="line">     root.remove(country)</span><br><span class="line"> </span><br><span class="line">tree.write(<span class="string">&#x27;output.xml&#x27;</span>)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#在country内添加（append）节点year2</span></span><br><span class="line"><span class="keyword">import</span> xml.etree.ElementTree <span class="keyword">as</span> ET</span><br><span class="line">tree = ET.parse(<span class="string">&quot;a.xml&quot;</span>)</span><br><span class="line">root=tree.getroot()</span><br><span class="line"><span class="keyword">for</span> country <span class="keyword">in</span> root.findall(<span class="string">&#x27;country&#x27;</span>):</span><br><span class="line">    <span class="keyword">for</span> year <span class="keyword">in</span> country.findall(<span class="string">&#x27;year&#x27;</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">int</span>(year.text) &gt; <span class="number">2000</span>:</span><br><span class="line">            year2=ET.Element(<span class="string">&#x27;year2&#x27;</span>)</span><br><span class="line">            year2.text=<span class="string">&#x27;新年&#x27;</span></span><br><span class="line">            year2.attrib=&#123;<span class="string">&#x27;update&#x27;</span>:<span class="string">&#x27;yes&#x27;</span>&#125;</span><br><span class="line">            country.append(year2) <span class="comment">#往country节点下添加子节点</span></span><br><span class="line"></span><br><span class="line">tree.write(<span class="string">&#x27;a.xml.swap&#x27;</span>)</span><br></pre></td></tr></table></figure><p>自己创建xml文档：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> xml.etree.ElementTree <span class="keyword">as</span> ET</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">new_xml = ET.Element(<span class="string">&quot;namelist&quot;</span>)</span><br><span class="line">name = ET.SubElement(new_xml,<span class="string">&quot;name&quot;</span>,attrib=&#123;<span class="string">&quot;enrolled&quot;</span>:<span class="string">&quot;yes&quot;</span>&#125;)</span><br><span class="line">age = ET.SubElement(name,<span class="string">&quot;age&quot;</span>,attrib=&#123;<span class="string">&quot;checked&quot;</span>:<span class="string">&quot;no&quot;</span>&#125;)</span><br><span class="line">sex = ET.SubElement(name,<span class="string">&quot;sex&quot;</span>)</span><br><span class="line">sex.text = <span class="string">&#x27;33&#x27;</span></span><br><span class="line">name2 = ET.SubElement(new_xml,<span class="string">&quot;name&quot;</span>,attrib=&#123;<span class="string">&quot;enrolled&quot;</span>:<span class="string">&quot;no&quot;</span>&#125;)</span><br><span class="line">age = ET.SubElement(name2,<span class="string">&quot;age&quot;</span>)</span><br><span class="line">age.text = <span class="string">&#x27;19&#x27;</span></span><br><span class="line"> </span><br><span class="line">et = ET.ElementTree(new_xml) <span class="comment">#生成文档对象</span></span><br><span class="line">et.write(<span class="string">&quot;test.xml&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>,xml_declaration=<span class="literal">True</span>)</span><br><span class="line"> </span><br><span class="line">ET.dump(new_xml) <span class="comment">#打印生成的格式</span></span><br></pre></td></tr></table></figure><h1 id="configparser模块"><a href="#configparser模块" class="headerlink" title="configparser模块"></a>configparser模块</h1><p>配置文件如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 注释1</span></span><br><span class="line"><span class="comment"># 注释2</span></span><br><span class="line"></span><br><span class="line">[section1]</span><br><span class="line">k1 = v1</span><br><span class="line">k2:v2</span><br><span class="line">user=allen</span><br><span class="line">age=<span class="number">18</span></span><br><span class="line">is_admin=true</span><br><span class="line">salary=<span class="number">31</span></span><br><span class="line">[section2]</span><br><span class="line">k1 = v1</span><br></pre></td></tr></table></figure><h2 id="读取"><a href="#读取" class="headerlink" title="读取"></a>读取</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> configparser</span><br><span class="line"></span><br><span class="line">config=configparser.ConfigParser()</span><br><span class="line">config.read(<span class="string">&#x27;a.cfg&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#查看所有的标题</span></span><br><span class="line">res=config.sections() <span class="comment">#[&#x27;section1&#x27;, &#x27;section2&#x27;]</span></span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"></span><br><span class="line"><span class="comment">#查看标题section1下所有key=value的key</span></span><br><span class="line">options=config.options(<span class="string">&#x27;section1&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(options) <span class="comment">#[&#x27;k1&#x27;, &#x27;k2&#x27;, &#x27;user&#x27;, &#x27;age&#x27;, &#x27;is_admin&#x27;, &#x27;salary&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#查看标题section1下所有key=value的(key,value)格式</span></span><br><span class="line">item_list=config.items(<span class="string">&#x27;section1&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(item_list) <span class="comment">#[(&#x27;k1&#x27;, &#x27;v1&#x27;), (&#x27;k2&#x27;, &#x27;v2&#x27;), (&#x27;user&#x27;, &#x27;allen&#x27;), (&#x27;age&#x27;, &#x27;18&#x27;), (&#x27;is_admin&#x27;, &#x27;true&#x27;), (&#x27;salary&#x27;, &#x27;31&#x27;)]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#查看标题section1下user的值=&gt;字符串格式</span></span><br><span class="line">val=config.get(<span class="string">&#x27;section1&#x27;</span>,<span class="string">&#x27;user&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(val) <span class="comment">#allen</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#查看标题section1下age的值=&gt;整数格式</span></span><br><span class="line">val1=config.getint(<span class="string">&#x27;section1&#x27;</span>,<span class="string">&#x27;age&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(val1) <span class="comment">#18</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#查看标题section1下is_admin的值=&gt;布尔值格式</span></span><br><span class="line">val2=config.getboolean(<span class="string">&#x27;section1&#x27;</span>,<span class="string">&#x27;is_admin&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(val2) <span class="comment">#True</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#查看标题section1下salary的值=&gt;浮点型格式</span></span><br><span class="line">val3=config.getfloat(<span class="string">&#x27;section1&#x27;</span>,<span class="string">&#x27;salary&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(val3) <span class="comment">#31.0</span></span><br></pre></td></tr></table></figure><h2 id="改写"><a href="#改写" class="headerlink" title="改写"></a>改写</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> configparser</span><br><span class="line"></span><br><span class="line">config=configparser.ConfigParser()</span><br><span class="line">config.read(<span class="string">&#x27;a.cfg&#x27;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#删除整个标题section2</span></span><br><span class="line">config.remove_section(<span class="string">&#x27;section2&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#删除标题section1下的某个k1和k2</span></span><br><span class="line">config.remove_option(<span class="string">&#x27;section1&#x27;</span>,<span class="string">&#x27;k1&#x27;</span>)</span><br><span class="line">config.remove_option(<span class="string">&#x27;section1&#x27;</span>,<span class="string">&#x27;k2&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#判断是否存在某个标题</span></span><br><span class="line"><span class="built_in">print</span>(config.has_section(<span class="string">&#x27;section1&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">#判断标题section1下是否有user</span></span><br><span class="line"><span class="built_in">print</span>(config.has_option(<span class="string">&#x27;section1&#x27;</span>,<span class="string">&#x27;&#x27;</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#添加一个标题</span></span><br><span class="line">config.add_section(<span class="string">&#x27;allen&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#在标题allen下添加name=allen,age=18的配置</span></span><br><span class="line">config.<span class="built_in">set</span>(<span class="string">&#x27;allen&#x27;</span>,<span class="string">&#x27;name&#x27;</span>,<span class="string">&#x27;allen&#x27;</span>)</span><br><span class="line">config.<span class="built_in">set</span>(<span class="string">&#x27;allen&#x27;</span>,<span class="string">&#x27;age&#x27;</span>,<span class="number">18</span>) <span class="comment">#报错,必须是字符串</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#最后将修改的内容写入文件,完成最终的修改</span></span><br><span class="line">config.write(<span class="built_in">open</span>(<span class="string">&#x27;a.cfg&#x27;</span>,<span class="string">&#x27;w&#x27;</span>))</span><br></pre></td></tr></table></figure><p><code>基于上述方法添加一个ini文档</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> configparser</span><br><span class="line">  </span><br><span class="line">config = configparser.ConfigParser()</span><br><span class="line">config[<span class="string">&quot;DEFAULT&quot;</span>] = &#123;<span class="string">&#x27;ServerAliveInterval&#x27;</span>: <span class="string">&#x27;45&#x27;</span>,</span><br><span class="line">                      <span class="string">&#x27;Compression&#x27;</span>: <span class="string">&#x27;yes&#x27;</span>,</span><br><span class="line">                     <span class="string">&#x27;CompressionLevel&#x27;</span>: <span class="string">&#x27;9&#x27;</span>&#125;</span><br><span class="line">  </span><br><span class="line">config[<span class="string">&#x27;bitbucket.org&#x27;</span>] = &#123;&#125;</span><br><span class="line">config[<span class="string">&#x27;bitbucket.org&#x27;</span>][<span class="string">&#x27;User&#x27;</span>] = <span class="string">&#x27;hg&#x27;</span></span><br><span class="line">config[<span class="string">&#x27;topsecret.server.com&#x27;</span>] = &#123;&#125;</span><br><span class="line">topsecret = config[<span class="string">&#x27;topsecret.server.com&#x27;</span>]</span><br><span class="line">topsecret[<span class="string">&#x27;Host Port&#x27;</span>] = <span class="string">&#x27;50022&#x27;</span>     <span class="comment"># mutates the parser</span></span><br><span class="line">topsecret[<span class="string">&#x27;ForwardX11&#x27;</span>] = <span class="string">&#x27;no&#x27;</span>  <span class="comment"># same here</span></span><br><span class="line">config[<span class="string">&#x27;DEFAULT&#x27;</span>][<span class="string">&#x27;ForwardX11&#x27;</span>] = <span class="string">&#x27;yes&#x27;</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;example.ini&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> configfile:</span><br><span class="line">   config.write(configfile)</span><br></pre></td></tr></table></figure><h1 id="hashlib模块"><a href="#hashlib模块" class="headerlink" title="hashlib模块"></a>hashlib模块</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1、什么叫hash:hash是一种算法（3.x里代替了md5模块和sha模块，主要提供 SHA1, SHA224, SHA256, SHA384, SHA512 ，MD5 算法），该算法接受传入的内容，经过运算得到一串hash值</span></span><br><span class="line"><span class="comment"># 2、hash值的特点是：</span></span><br><span class="line"><span class="comment">#2.1 只要传入的内容一样，得到的hash值必然一样=====&gt;要用明文传输密码文件完整性校验</span></span><br><span class="line"><span class="comment">#2.2 不能由hash值返解成内容=======》把密码做成hash值，不应该在网络传输明文密码</span></span><br><span class="line"><span class="comment">#2.3 只要使用的hash算法不变，无论校验的内容有多大，得到的hash值长度是固定的</span></span><br></pre></td></tr></table></figure><p>hash算法就像一座工厂，工厂接收你送来的原材料（可以用m.update()为工厂运送原材料），经过加工返回的产品就是hash值</p><p><img src="1036857-20180410101832069-1144106861.png" alt="img"><br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"> </span><br><span class="line">m=hashlib.md5()<span class="comment"># m=hashlib.sha256()</span></span><br><span class="line"> </span><br><span class="line">m.update(<span class="string">&#x27;hello&#x27;</span>.encode(<span class="string">&#x27;utf8&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(m.hexdigest())  <span class="comment">#5d41402abc4b2a76b9719d911017c592</span></span><br><span class="line"> </span><br><span class="line">m.update(<span class="string">&#x27;alvin&#x27;</span>.encode(<span class="string">&#x27;utf8&#x27;</span>))</span><br><span class="line"> </span><br><span class="line"><span class="built_in">print</span>(m.hexdigest())  <span class="comment">#92a7e713c30abbb0319fa07da2a5c4af</span></span><br><span class="line"> </span><br><span class="line">m2=hashlib.md5()</span><br><span class="line">m2.update(<span class="string">&#x27;helloalvin&#x27;</span>.encode(<span class="string">&#x27;utf8&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(m2.hexdigest()) <span class="comment">#92a7e713c30abbb0319fa07da2a5c4af</span></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">注意：把一段很长的数据update多次，与一次update这段长数据，得到的结果一样</span></span><br><span class="line"><span class="string">但是update多次为校验大文件提供了可能。</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p></p><p>以上加密算法虽然依然非常厉害，但时候存在缺陷，即：通过撞库可以反解。所以，有必要对加密算法中添加自定义key再来做加密。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"> </span><br><span class="line"><span class="comment"># ######## 256 ########</span></span><br><span class="line"> </span><br><span class="line"><span class="built_in">hash</span> = hashlib.sha256(<span class="string">&#x27;898oaFs09f&#x27;</span>.encode(<span class="string">&#x27;utf8&#x27;</span>))</span><br><span class="line"><span class="built_in">hash</span>.update(<span class="string">&#x27;alvin&#x27;</span>.encode(<span class="string">&#x27;utf8&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span> (<span class="built_in">hash</span>.hexdigest())<span class="comment">#e79e68f070cdedcfe63eaf1a2e92c83b4cfb1b5c6bc452d214c1b7e77cdfd1c7</span></span><br></pre></td></tr></table></figure><p><code>模拟撞库破解密码</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">passwds=[</span><br><span class="line">    <span class="string">&#x27;alex3714&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;alex1313&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;alex94139413&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;alex123456&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;123456alex&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;a123lex&#x27;</span>,</span><br><span class="line">    ]</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">make_passwd_dic</span>(<span class="params">passwds</span>):</span><br><span class="line">    dic=&#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> passwd <span class="keyword">in</span> passwds:</span><br><span class="line">        m=hashlib.md5()</span><br><span class="line">        m.update(passwd.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">        dic[passwd]=m.hexdigest()</span><br><span class="line">    <span class="keyword">return</span> dic</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">break_code</span>(<span class="params">cryptograph,passwd_dic</span>):</span><br><span class="line">    <span class="keyword">for</span> k,v <span class="keyword">in</span> passwd_dic.items():</span><br><span class="line">        <span class="keyword">if</span> v == cryptograph:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;密码是===&gt;\033[46m%s\033[0m&#x27;</span> %k)</span><br><span class="line"></span><br><span class="line">cryptograph=<span class="string">&#x27;aee949757a2e698417463d47acac93df&#x27;</span></span><br><span class="line">break_code(cryptograph,make_passwd_dic(passwds))</span><br></pre></td></tr></table></figure><p>python 还有一个 hmac 模块，它内部对我们创建 key 和 内容 进行进一步的处理然后再加密:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hmac</span><br><span class="line">h = hmac.new(<span class="string">&#x27;alvin&#x27;</span>.encode(<span class="string">&#x27;utf8&#x27;</span>))</span><br><span class="line">h.update(<span class="string">&#x27;hello&#x27;</span>.encode(<span class="string">&#x27;utf8&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span> (h.hexdigest())<span class="comment">#320df9832eab4c038b6c1d7ed73a5940</span></span><br></pre></td></tr></table></figure><p><code>注意！注意！注意</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#要想保证hmac最终结果一致，必须保证：</span></span><br><span class="line"><span class="comment">#1:hmac.new括号内指定的初始key一样</span></span><br><span class="line"><span class="comment">#2:无论update多少次，校验的内容累加到一起是一样的内容</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> hmac</span><br><span class="line"></span><br><span class="line">h1=hmac.new(<span class="string">b&#x27;allen&#x27;</span>)</span><br><span class="line">h1.update(<span class="string">b&#x27;hello&#x27;</span>)</span><br><span class="line">h1.update(<span class="string">b&#x27;world&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(h1.hexdigest())</span><br><span class="line"></span><br><span class="line">h2=hmac.new(<span class="string">b&#x27;allen&#x27;</span>)</span><br><span class="line">h2.update(<span class="string">b&#x27;helloworld&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(h2.hexdigest())</span><br><span class="line"></span><br><span class="line">h3=hmac.new(<span class="string">b&#x27;allenhelloworld&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(h3.hexdigest())</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">f1bf38d054691688f89dcd34ac3c27f2</span></span><br><span class="line"><span class="string">f1bf38d054691688f89dcd34ac3c27f2</span></span><br><span class="line"><span class="string">bcca84edd9eeb86f30539922b28f3981</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><h1 id="suprocess模块"><a href="#suprocess模块" class="headerlink" title="suprocess模块"></a>suprocess模块</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span>  subprocess</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">sh-3.2# ls /Users/allen/Desktop |grep txt$</span></span><br><span class="line"><span class="string">mysql.txt</span></span><br><span class="line"><span class="string">tt.txt</span></span><br><span class="line"><span class="string">事物.txt</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">res1=subprocess.Popen(<span class="string">&#x27;ls /Users/jieli/Desktop&#x27;</span>,shell=<span class="literal">True</span>,stdout=subprocess.PIPE)</span><br><span class="line">res=subprocess.Popen(<span class="string">&#x27;grep txt$&#x27;</span>,shell=<span class="literal">True</span>,stdin=res1.stdout,</span><br><span class="line">                 stdout=subprocess.PIPE)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(res.stdout.read().decode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#等同于上面,但是上面的优势在于,一个数据流可以和另外一个数据流交互,可以通过爬虫得到结果然后交给grep</span></span><br><span class="line">res1=subprocess.Popen(<span class="string">&#x27;ls /Users/jieli/Desktop |grep txt$&#x27;</span>,shell=<span class="literal">True</span>,stdout=subprocess.PIPE)</span><br><span class="line"><span class="built_in">print</span>(res1.stdout.read().decode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#windows下:</span></span><br><span class="line"><span class="comment"># dir | findstr &#x27;test*&#x27;</span></span><br><span class="line"><span class="comment"># dir | findstr &#x27;txt$&#x27;</span></span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line">res1=subprocess.Popen(<span class="string">r&#x27;dir C:\Users\Administrator\PycharmProjects\test\函数备课&#x27;</span>,shell=<span class="literal">True</span>,stdout=subprocess.PIPE)</span><br><span class="line">res=subprocess.Popen(<span class="string">&#x27;findstr test*&#x27;</span>,shell=<span class="literal">True</span>,stdin=res1.stdout,</span><br><span class="line">                 stdout=subprocess.PIPE)</span><br><span class="line"></span><br><span class="line"><span class="comment">#subprocess使用当前系统默认编码，得到结果为bytes类型，在windows下需要用gbk解码</span></span><br><span class="line"><span class="built_in">print</span>(res.stdout.read().decode(<span class="string">&#x27;gbk&#x27;</span>)) </span><br></pre></td></tr></table></figure><p><a target="_blank" rel="noopener" href="https://docs.python.org/3.6/library/subprocess.html?highlight=subprocess#frequently-used-arguments">详细参考官网</a></p><h1 id="logging模块"><a href="#logging模块" class="headerlink" title="logging模块"></a>logging模块</h1><h2 id="日志级别"><a href="#日志级别" class="headerlink" title="日志级别"></a>日志级别</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">CRITICAL = <span class="number">50</span> <span class="comment">#FATAL = CRITICAL</span></span><br><span class="line">ERROR = <span class="number">40</span></span><br><span class="line">WARNING = <span class="number">30</span> <span class="comment">#WARN = WARNING</span></span><br><span class="line">INFO = <span class="number">20</span></span><br><span class="line">DEBUG = <span class="number">10</span></span><br><span class="line">NOTSET = <span class="number">0</span> <span class="comment">#不设置</span></span><br></pre></td></tr></table></figure><h2 id="默认级别为warning，默认打印到终端"><a href="#默认级别为warning，默认打印到终端" class="headerlink" title="默认级别为warning，默认打印到终端"></a>默认级别为warning，默认打印到终端</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"></span><br><span class="line">logging.debug(<span class="string">&#x27;调试debug&#x27;</span>)</span><br><span class="line">logging.info(<span class="string">&#x27;消息info&#x27;</span>)</span><br><span class="line">logging.warning(<span class="string">&#x27;警告warn&#x27;</span>)</span><br><span class="line">logging.error(<span class="string">&#x27;错误error&#x27;</span>)</span><br><span class="line">logging.critical(<span class="string">&#x27;严重critical&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">WARNING:root:警告warn</span></span><br><span class="line"><span class="string">ERROR:root:错误error</span></span><br><span class="line"><span class="string">CRITICAL:root:严重critical</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="为logging模块指定全局配置，针对所有logger有效，控制打印到文件中"><a href="#为logging模块指定全局配置，针对所有logger有效，控制打印到文件中" class="headerlink" title="为logging模块指定全局配置，针对所有logger有效，控制打印到文件中"></a>为logging模块指定全局配置，针对所有logger有效，控制打印到文件中</h2><p><code>logging.basicConfig()</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">可在logging.basicConfig()函数中通过具体参数来更改logging模块默认行为，可用参数有</span><br><span class="line">filename：用指定的文件名创建FiledHandler（后边会具体讲解handler的概念），这样日志会被存储在指定的文件中。</span><br><span class="line">filemode：文件打开方式，在指定了filename时使用这个参数，默认值为“a”还可指定为“w”。</span><br><span class="line"><span class="built_in">format</span>：指定handler使用的日志显示格式。 </span><br><span class="line">datefmt：指定日期时间格式。 </span><br><span class="line">level：设置rootlogger（后边会讲解具体概念）的日志级别 </span><br><span class="line">stream：用指定的stream创建StreamHandler。可以指定输出到sys.stderr,sys.stdout或者文件，默认为sys.stderr。若同时列出了filename和stream两个参数，则stream参数会被忽略。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#格式</span></span><br><span class="line">%(name)s：Logger的名字，并非用户名，详细查看</span><br><span class="line"></span><br><span class="line">%(levelno)s：数字形式的日志级别</span><br><span class="line"></span><br><span class="line">%(levelname)s：文本形式的日志级别</span><br><span class="line"></span><br><span class="line">%(pathname)s：调用日志输出函数的模块的完整路径名，可能没有</span><br><span class="line"></span><br><span class="line">%(filename)s：调用日志输出函数的模块的文件名</span><br><span class="line"></span><br><span class="line">%(module)s：调用日志输出函数的模块名</span><br><span class="line"></span><br><span class="line">%(funcName)s：调用日志输出函数的函数名</span><br><span class="line"></span><br><span class="line">%(lineno)d：调用日志输出函数的语句所在的代码行</span><br><span class="line"></span><br><span class="line">%(created)f：当前时间，用UNIX标准的表示时间的浮 点数表示</span><br><span class="line"></span><br><span class="line">%(relativeCreated)d：输出日志信息时的，自Logger创建以 来的毫秒数</span><br><span class="line"></span><br><span class="line">%(asctime)s：字符串形式的当前时间。默认格式是 “<span class="number">2003</span>-07-08 <span class="number">16</span>:<span class="number">49</span>:<span class="number">45</span>,<span class="number">896</span>”。逗号后面的是毫秒</span><br><span class="line"></span><br><span class="line">%(thread)d：线程ID。可能没有</span><br><span class="line"></span><br><span class="line">%(threadName)s：线程名。可能没有</span><br><span class="line"></span><br><span class="line">%(process)d：进程ID。可能没有</span><br><span class="line"></span><br><span class="line">%(message)s：用户输出的消息</span><br><span class="line"></span><br><span class="line"> </span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#======介绍</span></span><br><span class="line">可在logging.basicConfig()函数中可通过具体参数来更改logging模块默认行为，可用参数有</span><br><span class="line">filename：用指定的文件名创建FiledHandler（后边会具体讲解handler的概念），这样日志会被存储在指定的文件中。</span><br><span class="line">filemode：文件打开方式，在指定了filename时使用这个参数，默认值为“a”还可指定为“w”。</span><br><span class="line"><span class="built_in">format</span>：指定handler使用的日志显示格式。</span><br><span class="line">datefmt：指定日期时间格式。</span><br><span class="line">level：设置rootlogger（后边会讲解具体概念）的日志级别</span><br><span class="line">stream：用指定的stream创建StreamHandler。可以指定输出到sys.stderr,sys.stdout或者文件，默认为sys.stderr。若同时列出了filename和stream两个参数，则stream参数会被忽略。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">format</span>参数中可能用到的格式化串：</span><br><span class="line">%(name)s Logger的名字</span><br><span class="line">%(levelno)s 数字形式的日志级别</span><br><span class="line">%(levelname)s 文本形式的日志级别</span><br><span class="line">%(pathname)s 调用日志输出函数的模块的完整路径名，可能没有</span><br><span class="line">%(filename)s 调用日志输出函数的模块的文件名</span><br><span class="line">%(module)s 调用日志输出函数的模块名</span><br><span class="line">%(funcName)s 调用日志输出函数的函数名</span><br><span class="line">%(lineno)d 调用日志输出函数的语句所在的代码行</span><br><span class="line">%(created)f 当前时间，用UNIX标准的表示时间的浮 点数表示</span><br><span class="line">%(relativeCreated)d 输出日志信息时的，自Logger创建以 来的毫秒数</span><br><span class="line">%(asctime)s 字符串形式的当前时间。默认格式是 “<span class="number">2003</span>-07-08 <span class="number">16</span>:<span class="number">49</span>:<span class="number">45</span>,<span class="number">896</span>”。逗号后面的是毫秒</span><br><span class="line">%(thread)d 线程ID。可能没有</span><br><span class="line">%(threadName)s 线程名。可能没有</span><br><span class="line">%(process)d 进程ID。可能没有</span><br><span class="line">%(message)s用户输出的消息</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#========使用</span></span><br><span class="line"><span class="keyword">import</span> logging</span><br><span class="line">logging.basicConfig(filename=<span class="string">&#x27;access.log&#x27;</span>,</span><br><span class="line">                    <span class="built_in">format</span>=<span class="string">&#x27;%(asctime)s - %(name)s - %(levelname)s -%(module)s:  %(message)s&#x27;</span>,</span><br><span class="line">                    datefmt=<span class="string">&#x27;%Y-%m-%d %H:%M:%S %p&#x27;</span>,</span><br><span class="line">                    level=<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">logging.debug(<span class="string">&#x27;调试debug&#x27;</span>)</span><br><span class="line">logging.info(<span class="string">&#x27;消息info&#x27;</span>)</span><br><span class="line">logging.warning(<span class="string">&#x27;警告warn&#x27;</span>)</span><br><span class="line">logging.error(<span class="string">&#x27;错误error&#x27;</span>)</span><br><span class="line">logging.critical(<span class="string">&#x27;严重critical&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#========结果</span></span><br><span class="line">access.log内容:</span><br><span class="line"><span class="number">2017</span>-07-<span class="number">28</span> <span class="number">20</span>:<span class="number">32</span>:<span class="number">17</span> PM - root - DEBUG -test:  调试debug</span><br><span class="line"><span class="number">2017</span>-07-<span class="number">28</span> <span class="number">20</span>:<span class="number">32</span>:<span class="number">17</span> PM - root - INFO -test:  消息info</span><br><span class="line"><span class="number">2017</span>-07-<span class="number">28</span> <span class="number">20</span>:<span class="number">32</span>:<span class="number">17</span> PM - root - WARNING -test:  警告warn</span><br><span class="line"><span class="number">2017</span>-07-<span class="number">28</span> <span class="number">20</span>:<span class="number">32</span>:<span class="number">17</span> PM - root - ERROR -test:  错误error</span><br><span class="line"><span class="number">2017</span>-07-<span class="number">28</span> <span class="number">20</span>:<span class="number">32</span>:<span class="number">17</span> PM - root - CRITICAL -test:  严重critical</span><br><span class="line"></span><br><span class="line">part2: 可以为logging模块指定模块级的配置,即所有logger的配置</span><br></pre></td></tr></table></figure><h2 id="logging模块的Formatter，Handler，Logger，Filter对象"><a href="#logging模块的Formatter，Handler，Logger，Filter对象" class="headerlink" title="logging模块的Formatter，Handler，Logger，Filter对象"></a>logging模块的Formatter，Handler，Logger，Filter对象</h2><p><a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1skWyTT7"><strong>原理图：https://pan.baidu.com/s/1skWyTT7</strong></a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#logger：产生日志的对象</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#Filter：过滤日志的对象</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#Handler：接收日志然后控制打印到不同的地方，FileHandler用来打印到文件中，StreamHandler用来打印到终端</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#Formatter对象：可以定制不同的日志格式对象，然后绑定给不同的Handler对象使用，以此来控制不同的Handler的日志格式</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">critical=50</span></span><br><span class="line"><span class="string">error =40</span></span><br><span class="line"><span class="string">warning =30</span></span><br><span class="line"><span class="string">info = 20</span></span><br><span class="line"><span class="string">debug =10</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"></span><br><span class="line"><span class="comment">#1、logger对象：负责产生日志，然后交给Filter过滤，然后交给不同的Handler输出</span></span><br><span class="line">logger=logging.getLogger(__file__)</span><br><span class="line"></span><br><span class="line"><span class="comment">#2、Filter对象：不常用，略</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#3、Handler对象：接收logger传来的日志，然后控制输出</span></span><br><span class="line">h1=logging.FileHandler(<span class="string">&#x27;t1.log&#x27;</span>) <span class="comment">#打印到文件</span></span><br><span class="line">h2=logging.FileHandler(<span class="string">&#x27;t2.log&#x27;</span>) <span class="comment">#打印到文件</span></span><br><span class="line">h3=logging.StreamHandler() <span class="comment">#打印到终端</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#4、Formatter对象：日志格式</span></span><br><span class="line">formmater1=logging.Formatter(<span class="string">&#x27;%(asctime)s - %(name)s - %(levelname)s -%(module)s:  %(message)s&#x27;</span>,</span><br><span class="line">                    datefmt=<span class="string">&#x27;%Y-%m-%d %H:%M:%S %p&#x27;</span>,)</span><br><span class="line"></span><br><span class="line">formmater2=logging.Formatter(<span class="string">&#x27;%(asctime)s :  %(message)s&#x27;</span>,</span><br><span class="line">                    datefmt=<span class="string">&#x27;%Y-%m-%d %H:%M:%S %p&#x27;</span>,)</span><br><span class="line"></span><br><span class="line">formmater3=logging.Formatter(<span class="string">&#x27;%(name)s %(message)s&#x27;</span>,)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#5、为Handler对象绑定格式</span></span><br><span class="line">h1.setFormatter(formmater1)</span><br><span class="line">h2.setFormatter(formmater2)</span><br><span class="line">h3.setFormatter(formmater3)</span><br><span class="line"></span><br><span class="line"><span class="comment">#6、将Handler添加给logger并设置日志级别</span></span><br><span class="line">logger.addHandler(h1)</span><br><span class="line">logger.addHandler(h2)</span><br><span class="line">logger.addHandler(h3)</span><br><span class="line">logger.setLevel(<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#7、测试</span></span><br><span class="line">logger.debug(<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">logger.info(<span class="string">&#x27;info&#x27;</span>)</span><br><span class="line">logger.warning(<span class="string">&#x27;warning&#x27;</span>)</span><br><span class="line">logger.error(<span class="string">&#x27;error&#x27;</span>)</span><br><span class="line">logger.critical(<span class="string">&#x27;critical&#x27;</span>)</span><br></pre></td></tr></table></figure><h2 id="Logger与Handler的级别"><a href="#Logger与Handler的级别" class="headerlink" title="Logger与Handler的级别"></a>Logger与Handler的级别</h2><p>logger是第一级过滤，然后才能到handler，我们可以给logger和handler同时设置level，但是需要注意的是</p><p><code>重要，重要，重要！！！</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">Logger <span class="keyword">is</span> also the first to <span class="built_in">filter</span> the message based on a level — <span class="keyword">if</span> you <span class="built_in">set</span> the logger to INFO, <span class="keyword">and</span> <span class="built_in">all</span> handlers to DEBUG, you still won<span class="string">&#x27;t receive DEBUG messages on handlers — they&#x27;</span>ll be rejected by the logger itself. If you <span class="built_in">set</span> logger to DEBUG, but <span class="built_in">all</span> handlers to INFO, you won<span class="string">&#x27;t receive any DEBUG messages either — because while the logger says &quot;ok, process this&quot;, the handlers reject it (DEBUG &lt; INFO).</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#验证</span></span><br><span class="line"><span class="string">import logging</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">form=logging.Formatter(&#x27;</span>%(asctime)s - %(name)s - %(levelname)s -%(module)s:  %(message)s<span class="string">&#x27;,</span></span><br><span class="line"><span class="string">                    datefmt=&#x27;</span>%Y-%m-%d %H:%M:%S %p<span class="string">&#x27;,)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">ch=logging.StreamHandler()</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">ch.setFormatter(form)</span></span><br><span class="line"><span class="string"># ch.setLevel(10)</span></span><br><span class="line"><span class="string">ch.setLevel(20)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">l1=logging.getLogger(&#x27;</span>root<span class="string">&#x27;)</span></span><br><span class="line"><span class="string"># l1.setLevel(20)</span></span><br><span class="line"><span class="string">l1.setLevel(10)</span></span><br><span class="line"><span class="string">l1.addHandler(ch)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">l1.debug(&#x27;</span>l1 debug<span class="string">&#x27;)</span></span><br></pre></td></tr></table></figure><h2 id="Logger的继承（了解）"><a href="#Logger的继承（了解）" class="headerlink" title="Logger的继承（了解）"></a>Logger的继承（了解）</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"></span><br><span class="line">formatter=logging.Formatter(<span class="string">&#x27;%(asctime)s - %(name)s - %(levelname)s -%(module)s:  %(message)s&#x27;</span>,</span><br><span class="line">                    datefmt=<span class="string">&#x27;%Y-%m-%d %H:%M:%S %p&#x27;</span>,)</span><br><span class="line"></span><br><span class="line">ch=logging.StreamHandler()</span><br><span class="line">ch.setFormatter(formatter)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">logger1=logging.getLogger(<span class="string">&#x27;root&#x27;</span>)</span><br><span class="line">logger2=logging.getLogger(<span class="string">&#x27;root.child1&#x27;</span>)</span><br><span class="line">logger3=logging.getLogger(<span class="string">&#x27;root.child1.child2&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">logger1.addHandler(ch)</span><br><span class="line">logger2.addHandler(ch)</span><br><span class="line">logger3.addHandler(ch)</span><br><span class="line">logger1.setLevel(<span class="number">10</span>)</span><br><span class="line">logger2.setLevel(<span class="number">10</span>)</span><br><span class="line">logger3.setLevel(<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">logger1.debug(<span class="string">&#x27;log1 debug&#x27;</span>)</span><br><span class="line">logger2.debug(<span class="string">&#x27;log2 debug&#x27;</span>)</span><br><span class="line">logger3.debug(<span class="string">&#x27;log3 debug&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">2017-07-28 22:22:05 PM - root - DEBUG -test:  log1 debug</span></span><br><span class="line"><span class="string">2017-07-28 22:22:05 PM - root.child1 - DEBUG -test:  log2 debug</span></span><br><span class="line"><span class="string">2017-07-28 22:22:05 PM - root.child1 - DEBUG -test:  log2 debug</span></span><br><span class="line"><span class="string">2017-07-28 22:22:05 PM - root.child1.child2 - DEBUG -test:  log3 debug</span></span><br><span class="line"><span class="string">2017-07-28 22:22:05 PM - root.child1.child2 - DEBUG -test:  log3 debug</span></span><br><span class="line"><span class="string">2017-07-28 22:22:05 PM - root.child1.child2 - DEBUG -test:  log3 debug</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="应用"><a href="#应用" class="headerlink" title="应用"></a>应用</h2><p><code>logging配置文件</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">logging配置</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> logging.config</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义三种日志输出格式 开始</span></span><br><span class="line"></span><br><span class="line">standard_format = <span class="string">&#x27;[%(asctime)s][%(threadName)s:%(thread)d][task_id:%(name)s][%(filename)s:%(lineno)d]&#x27;</span> \</span><br><span class="line">                  <span class="string">&#x27;[%(levelname)s][%(message)s]&#x27;</span> <span class="comment">#其中name为getlogger指定的名字</span></span><br><span class="line"></span><br><span class="line">simple_format = <span class="string">&#x27;[%(levelname)s][%(asctime)s][%(filename)s:%(lineno)d]%(message)s&#x27;</span></span><br><span class="line"></span><br><span class="line">id_simple_format = <span class="string">&#x27;[%(levelname)s][%(asctime)s] %(message)s&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义日志输出格式 结束</span></span><br><span class="line"></span><br><span class="line">logfile_dir = os.path.dirname(os.path.abspath(__file__))  <span class="comment"># log文件的目录</span></span><br><span class="line"></span><br><span class="line">logfile_name = <span class="string">&#x27;all2.log&#x27;</span>  <span class="comment"># log文件名</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果不存在定义的日志目录就创建一个</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> os.path.isdir(logfile_dir):</span><br><span class="line">    os.mkdir(logfile_dir)</span><br><span class="line"></span><br><span class="line"><span class="comment"># log文件的全路径</span></span><br><span class="line">logfile_path = os.path.join(logfile_dir, logfile_name)</span><br><span class="line"></span><br><span class="line"><span class="comment"># log配置字典</span></span><br><span class="line">LOGGING_DIC = &#123;</span><br><span class="line">    <span class="string">&#x27;version&#x27;</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="string">&#x27;disable_existing_loggers&#x27;</span>: <span class="literal">False</span>,</span><br><span class="line">    <span class="string">&#x27;formatters&#x27;</span>: &#123;</span><br><span class="line">        <span class="string">&#x27;standard&#x27;</span>: &#123;</span><br><span class="line">            <span class="string">&#x27;format&#x27;</span>: standard_format</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">&#x27;simple&#x27;</span>: &#123;</span><br><span class="line">            <span class="string">&#x27;format&#x27;</span>: simple_format</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&#x27;filters&#x27;</span>: &#123;&#125;,</span><br><span class="line">    <span class="string">&#x27;handlers&#x27;</span>: &#123;</span><br><span class="line">        <span class="comment">#打印到终端的日志</span></span><br><span class="line">        <span class="string">&#x27;console&#x27;</span>: &#123;</span><br><span class="line">            <span class="string">&#x27;level&#x27;</span>: <span class="string">&#x27;DEBUG&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;class&#x27;</span>: <span class="string">&#x27;logging.StreamHandler&#x27;</span>,  <span class="comment"># 打印到屏幕</span></span><br><span class="line">            <span class="string">&#x27;formatter&#x27;</span>: <span class="string">&#x27;simple&#x27;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">#打印到文件的日志,收集info及以上的日志</span></span><br><span class="line">        <span class="string">&#x27;default&#x27;</span>: &#123;</span><br><span class="line">            <span class="string">&#x27;level&#x27;</span>: <span class="string">&#x27;DEBUG&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;class&#x27;</span>: <span class="string">&#x27;logging.handlers.RotatingFileHandler&#x27;</span>,  <span class="comment"># 保存到文件</span></span><br><span class="line">            <span class="string">&#x27;formatter&#x27;</span>: <span class="string">&#x27;standard&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;filename&#x27;</span>: logfile_path,  <span class="comment"># 日志文件</span></span><br><span class="line">            <span class="string">&#x27;maxBytes&#x27;</span>: <span class="number">1024</span>*<span class="number">1024</span>*<span class="number">5</span>,  <span class="comment"># 日志大小 5M</span></span><br><span class="line">            <span class="string">&#x27;backupCount&#x27;</span>: <span class="number">5</span>,</span><br><span class="line">            <span class="string">&#x27;encoding&#x27;</span>: <span class="string">&#x27;utf-8&#x27;</span>,  <span class="comment"># 日志文件的编码，再也不用担心中文log乱码了</span></span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&#x27;loggers&#x27;</span>: &#123;</span><br><span class="line">        <span class="comment">#logging.getLogger(__name__)拿到的logger配置</span></span><br><span class="line">        <span class="string">&#x27;&#x27;</span>: &#123;</span><br><span class="line">            <span class="string">&#x27;handlers&#x27;</span>: [<span class="string">&#x27;default&#x27;</span>, <span class="string">&#x27;console&#x27;</span>],  <span class="comment"># 这里把上面定义的两个handler都加上，即log数据既写入文件又打印到屏幕</span></span><br><span class="line">            <span class="string">&#x27;level&#x27;</span>: <span class="string">&#x27;DEBUG&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;propagate&#x27;</span>: <span class="literal">True</span>,  <span class="comment"># 向上（更高level的logger）传递</span></span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">load_my_logging_cfg</span>():</span><br><span class="line">    logging.config.dictConfig(LOGGING_DIC)  <span class="comment"># 导入上面定义的logging配置</span></span><br><span class="line">    logger = logging.getLogger(__name__)  <span class="comment"># 生成一个log实例</span></span><br><span class="line">    logger.info(<span class="string">&#x27;It works!&#x27;</span>)  <span class="comment"># 记录该文件的运行状态</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    load_my_logging_cfg()</span><br></pre></td></tr></table></figure><p>使用</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">MyLogging Test</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"><span class="keyword">import</span> my_logging  <span class="comment"># 导入自定义的logging配置</span></span><br><span class="line"></span><br><span class="line">logger = logging.getLogger(__name__)  <span class="comment"># 生成logger实例</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">demo</span>():</span><br><span class="line">    logger.debug(<span class="string">&quot;start range... time:&#123;&#125;&quot;</span>.<span class="built_in">format</span>(time.time()))</span><br><span class="line">    logger.info(<span class="string">&quot;中文测试开始。。。&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">        logger.debug(<span class="string">&quot;i:&#123;&#125;&quot;</span>.<span class="built_in">format</span>(i))</span><br><span class="line">        time.sleep(<span class="number">0.2</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        logger.debug(<span class="string">&quot;over range... time:&#123;&#125;&quot;</span>.<span class="built_in">format</span>(time.time()))</span><br><span class="line">    logger.info(<span class="string">&quot;中文测试结束。。。&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    my_logging.load_my_logging_cfg()  <span class="comment"># 在你程序文件的入口加载自定义logging配置</span></span><br><span class="line">    demo()</span><br></pre></td></tr></table></figure><p><code>!!!关于如何拿到logger对象的详细解释！！！</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">注意注意注意：</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#1、有了上述方式我们的好处是：所有与logging模块有关的配置都写到字典中就可以了，更加清晰，方便管理</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#2、我们需要解决的问题是：</span></span><br><span class="line">    <span class="number">1</span>、从字典加载配置：logging.config.dictConfig(settings.LOGGING_DIC)</span><br><span class="line"></span><br><span class="line">    <span class="number">2</span>、拿到logger对象来产生日志</span><br><span class="line">    logger对象都是配置到字典的loggers 键对应的子字典中的</span><br><span class="line">    按照我们对logging模块的理解，要想获取某个东西都是通过名字，也就是key来获取的</span><br><span class="line">    于是我们要获取不同的logger对象就是</span><br><span class="line">    logger=logging.getLogger(<span class="string">&#x27;loggers子字典的key名&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    但问题是：如果我们想要不同logger名的logger对象都共用一段配置，那么肯定不能在loggers子字典中定义n个key   </span><br><span class="line"> <span class="string">&#x27;loggers&#x27;</span>: &#123;    </span><br><span class="line">        <span class="string">&#x27;l1&#x27;</span>: &#123;</span><br><span class="line">            <span class="string">&#x27;handlers&#x27;</span>: [<span class="string">&#x27;default&#x27;</span>, <span class="string">&#x27;console&#x27;</span>],  <span class="comment">#</span></span><br><span class="line">            <span class="string">&#x27;level&#x27;</span>: <span class="string">&#x27;DEBUG&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;propagate&#x27;</span>: <span class="literal">True</span>,  <span class="comment"># 向上（更高level的logger）传递</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">&#x27;l2: &#123;</span></span><br><span class="line"><span class="string">            &#x27;</span>handlers<span class="string">&#x27;: [&#x27;</span>default<span class="string">&#x27;, &#x27;</span>console<span class="string">&#x27; ], </span></span><br><span class="line"><span class="string">            &#x27;</span>level<span class="string">&#x27;: &#x27;</span>DEBUG<span class="string">&#x27;,</span></span><br><span class="line"><span class="string">            &#x27;</span>propagate<span class="string">&#x27;: False,  # 向上（更高level的logger）传递</span></span><br><span class="line"><span class="string">        &#125;,</span></span><br><span class="line"><span class="string">        &#x27;</span>l3<span class="string">&#x27;: &#123;</span></span><br><span class="line"><span class="string">            &#x27;</span>handlers<span class="string">&#x27;: [&#x27;</span>default<span class="string">&#x27;, &#x27;</span>console<span class="string">&#x27;],  #</span></span><br><span class="line"><span class="string">            &#x27;</span>level<span class="string">&#x27;: &#x27;</span>DEBUG<span class="string">&#x27;,</span></span><br><span class="line"><span class="string">            &#x27;</span>propagate<span class="string">&#x27;: True,  # 向上（更高level的logger）传递</span></span><br><span class="line"><span class="string">        &#125;,</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">#我们的解决方式是，定义一个空的key</span></span><br><span class="line"><span class="string">    &#x27;</span>loggers<span class="string">&#x27;: &#123;</span></span><br><span class="line"><span class="string">        &#x27;</span><span class="string">&#x27;: &#123;</span></span><br><span class="line"><span class="string">            &#x27;</span>handlers<span class="string">&#x27;: [&#x27;</span>default<span class="string">&#x27;, &#x27;</span>console<span class="string">&#x27;], </span></span><br><span class="line"><span class="string">            &#x27;</span>level<span class="string">&#x27;: &#x27;</span>DEBUG<span class="string">&#x27;,</span></span><br><span class="line"><span class="string">            &#x27;</span>propagate<span class="string">&#x27;: True, </span></span><br><span class="line"><span class="string">        &#125;,</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">这样我们再取logger对象时</span></span><br><span class="line"><span class="string">logging.getLogger(__name__)，不同的文件__name__不同，这保证了打印日志时标识信息不同，但是拿着该名字去loggers里找key名时却发现找不到，于是默认使用key=&#x27;</span><span class="string">&#x27;的配置</span></span><br></pre></td></tr></table></figure><p>另外一个django的配置，瞄一眼就可以，跟上面的一样</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#logging_config.py</span></span><br><span class="line">LOGGING = &#123;</span><br><span class="line">    <span class="string">&#x27;version&#x27;</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="string">&#x27;disable_existing_loggers&#x27;</span>: <span class="literal">False</span>,</span><br><span class="line">    <span class="string">&#x27;formatters&#x27;</span>: &#123;</span><br><span class="line">        <span class="string">&#x27;standard&#x27;</span>: &#123;</span><br><span class="line">            <span class="string">&#x27;format&#x27;</span>: <span class="string">&#x27;[%(asctime)s][%(threadName)s:%(thread)d][task_id:%(name)s][%(filename)s:%(lineno)d]&#x27;</span></span><br><span class="line">                      <span class="string">&#x27;[%(levelname)s][%(message)s]&#x27;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">&#x27;simple&#x27;</span>: &#123;</span><br><span class="line">            <span class="string">&#x27;format&#x27;</span>: <span class="string">&#x27;[%(levelname)s][%(asctime)s][%(filename)s:%(lineno)d]%(message)s&#x27;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">&#x27;collect&#x27;</span>: &#123;</span><br><span class="line">            <span class="string">&#x27;format&#x27;</span>: <span class="string">&#x27;%(message)s&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&#x27;filters&#x27;</span>: &#123;</span><br><span class="line">        <span class="string">&#x27;require_debug_true&#x27;</span>: &#123;</span><br><span class="line">            <span class="string">&#x27;()&#x27;</span>: <span class="string">&#x27;django.utils.log.RequireDebugTrue&#x27;</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&#x27;handlers&#x27;</span>: &#123;</span><br><span class="line">        <span class="comment">#打印到终端的日志</span></span><br><span class="line">        <span class="string">&#x27;console&#x27;</span>: &#123;</span><br><span class="line">            <span class="string">&#x27;level&#x27;</span>: <span class="string">&#x27;DEBUG&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;filters&#x27;</span>: [<span class="string">&#x27;require_debug_true&#x27;</span>],</span><br><span class="line">            <span class="string">&#x27;class&#x27;</span>: <span class="string">&#x27;logging.StreamHandler&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;formatter&#x27;</span>: <span class="string">&#x27;simple&#x27;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">#打印到文件的日志,收集info及以上的日志</span></span><br><span class="line">        <span class="string">&#x27;default&#x27;</span>: &#123;</span><br><span class="line">            <span class="string">&#x27;level&#x27;</span>: <span class="string">&#x27;INFO&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;class&#x27;</span>: <span class="string">&#x27;logging.handlers.RotatingFileHandler&#x27;</span>,  <span class="comment"># 保存到文件，自动切</span></span><br><span class="line">            <span class="string">&#x27;filename&#x27;</span>: os.path.join(BASE_LOG_DIR, <span class="string">&quot;xxx_info.log&quot;</span>),  <span class="comment"># 日志文件</span></span><br><span class="line">            <span class="string">&#x27;maxBytes&#x27;</span>: <span class="number">1024</span> * <span class="number">1024</span> * <span class="number">5</span>,  <span class="comment"># 日志大小 5M</span></span><br><span class="line">            <span class="string">&#x27;backupCount&#x27;</span>: <span class="number">3</span>,</span><br><span class="line">            <span class="string">&#x27;formatter&#x27;</span>: <span class="string">&#x27;standard&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;encoding&#x27;</span>: <span class="string">&#x27;utf-8&#x27;</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">#打印到文件的日志:收集错误及以上的日志</span></span><br><span class="line">        <span class="string">&#x27;error&#x27;</span>: &#123;</span><br><span class="line">            <span class="string">&#x27;level&#x27;</span>: <span class="string">&#x27;ERROR&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;class&#x27;</span>: <span class="string">&#x27;logging.handlers.RotatingFileHandler&#x27;</span>,  <span class="comment"># 保存到文件，自动切</span></span><br><span class="line">            <span class="string">&#x27;filename&#x27;</span>: os.path.join(BASE_LOG_DIR, <span class="string">&quot;xxx_err.log&quot;</span>),  <span class="comment"># 日志文件</span></span><br><span class="line">            <span class="string">&#x27;maxBytes&#x27;</span>: <span class="number">1024</span> * <span class="number">1024</span> * <span class="number">5</span>,  <span class="comment"># 日志大小 5M</span></span><br><span class="line">            <span class="string">&#x27;backupCount&#x27;</span>: <span class="number">5</span>,</span><br><span class="line">            <span class="string">&#x27;formatter&#x27;</span>: <span class="string">&#x27;standard&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;encoding&#x27;</span>: <span class="string">&#x27;utf-8&#x27;</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">#打印到文件的日志</span></span><br><span class="line">        <span class="string">&#x27;collect&#x27;</span>: &#123;</span><br><span class="line">            <span class="string">&#x27;level&#x27;</span>: <span class="string">&#x27;INFO&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;class&#x27;</span>: <span class="string">&#x27;logging.handlers.RotatingFileHandler&#x27;</span>,  <span class="comment"># 保存到文件，自动切</span></span><br><span class="line">            <span class="string">&#x27;filename&#x27;</span>: os.path.join(BASE_LOG_DIR, <span class="string">&quot;xxx_collect.log&quot;</span>),</span><br><span class="line">            <span class="string">&#x27;maxBytes&#x27;</span>: <span class="number">1024</span> * <span class="number">1024</span> * <span class="number">5</span>,  <span class="comment"># 日志大小 5M</span></span><br><span class="line">            <span class="string">&#x27;backupCount&#x27;</span>: <span class="number">5</span>,</span><br><span class="line">            <span class="string">&#x27;formatter&#x27;</span>: <span class="string">&#x27;collect&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;encoding&#x27;</span>: <span class="string">&quot;utf-8&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&#x27;loggers&#x27;</span>: &#123;</span><br><span class="line">        <span class="comment">#logging.getLogger(__name__)拿到的logger配置</span></span><br><span class="line">        <span class="string">&#x27;&#x27;</span>: &#123;</span><br><span class="line">            <span class="string">&#x27;handlers&#x27;</span>: [<span class="string">&#x27;default&#x27;</span>, <span class="string">&#x27;console&#x27;</span>, <span class="string">&#x27;error&#x27;</span>],</span><br><span class="line">            <span class="string">&#x27;level&#x27;</span>: <span class="string">&#x27;DEBUG&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;propagate&#x27;</span>: <span class="literal">True</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">#logging.getLogger(&#x27;collect&#x27;)拿到的logger配置</span></span><br><span class="line">        <span class="string">&#x27;collect&#x27;</span>: &#123;</span><br><span class="line">            <span class="string">&#x27;handlers&#x27;</span>: [<span class="string">&#x27;console&#x27;</span>, <span class="string">&#x27;collect&#x27;</span>],</span><br><span class="line">            <span class="string">&#x27;level&#x27;</span>: <span class="string">&#x27;INFO&#x27;</span>,</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># -----------</span></span><br><span class="line"><span class="comment"># 用法:拿到俩个logger</span></span><br><span class="line"></span><br><span class="line">logger = logging.getLogger(__name__) <span class="comment">#线上正常的日志</span></span><br><span class="line">collect_logger = logging.getLogger(<span class="string">&quot;collect&quot;</span>) <span class="comment">#领导说,需要为领导们单独定制领导们看的日志</span></span><br></pre></td></tr></table></figure><h1 id="re模块"><a href="#re模块" class="headerlink" title="re模块"></a>re模块</h1><h2 id="一：什么是正则？"><a href="#一：什么是正则？" class="headerlink" title="一：什么是正则？"></a>一：什么是正则？</h2><p>正则就是用一些具有特殊含义的符号组合到一起（称为正则表达式）来描述字符或者字符串的方法。或者说：正则就是用来描述一类事物的规则。 （在Python中）它内嵌在Python中，并通过 re 模块实现。正则表达式模式被编译成一系列的字节码，然后由用 C 编写的匹配引擎执行。</p><p>生活中处处都是正则：</p><p>比如我们描述：4条腿</p><p>你可能会想到的是四条腿的动物或者桌子，椅子等</p><p>继续描述：4条腿，活的</p><p>就只剩下四条腿的动物这一类了</p><h2 id="二：常用匹配模式-元字符"><a href="#二：常用匹配模式-元字符" class="headerlink" title="二：常用匹配模式(元字符)"></a>二：常用匹配模式(元字符)</h2><p><a target="_blank" rel="noopener" href="http://blog.csdn.net/yufenghyc/article/details/51078107">http://blog.csdn.net/yufenghyc/article/details/51078107</a></p><p><img src="1036857-20170529203214461-666088398.png" alt="img"><br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># =================================匹配模式=================================</span></span><br><span class="line"><span class="comment">#一对一的匹配</span></span><br><span class="line"><span class="comment"># &#x27;hello&#x27;.replace(old,new)</span></span><br><span class="line"><span class="comment"># &#x27;hello&#x27;.find(&#x27;pattern&#x27;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#正则匹配</span></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="comment">#\w与\W</span></span><br><span class="line"><span class="built_in">print</span>(re.findall(<span class="string">&#x27;\w&#x27;</span>,<span class="string">&#x27;hello allen 123&#x27;</span>)) <span class="comment">#[&#x27;h&#x27;, &#x27;e&#x27;, &#x27;l&#x27;, &#x27;l&#x27;, &#x27;o&#x27;, &#x27;e&#x27;, &#x27;g&#x27;, &#x27;o&#x27;, &#x27;n&#x27;, &#x27;1&#x27;, &#x27;2&#x27;, &#x27;3&#x27;]</span></span><br><span class="line"><span class="built_in">print</span>(re.findall(<span class="string">&#x27;\W&#x27;</span>,<span class="string">&#x27;hello allen 123&#x27;</span>)) <span class="comment">#[&#x27; &#x27;, &#x27; &#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#\s与\S</span></span><br><span class="line"><span class="built_in">print</span>(re.findall(<span class="string">&#x27;\s&#x27;</span>,<span class="string">&#x27;hello  allen  123&#x27;</span>)) <span class="comment">#[&#x27; &#x27;, &#x27; &#x27;, &#x27; &#x27;, &#x27; &#x27;]</span></span><br><span class="line"><span class="built_in">print</span>(re.findall(<span class="string">&#x27;\S&#x27;</span>,<span class="string">&#x27;hello  allen  123&#x27;</span>)) <span class="comment">#[&#x27;h&#x27;, &#x27;e&#x27;, &#x27;l&#x27;, &#x27;l&#x27;, &#x27;o&#x27;, &#x27;e&#x27;, &#x27;g&#x27;, &#x27;o&#x27;, &#x27;n&#x27;, &#x27;1&#x27;, &#x27;2&#x27;, &#x27;3&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#\n \t都是空,都可以被\s匹配</span></span><br><span class="line"><span class="built_in">print</span>(re.findall(<span class="string">&#x27;\s&#x27;</span>,<span class="string">&#x27;hello \n allen \t 123&#x27;</span>)) <span class="comment">#[&#x27; &#x27;, &#x27;\n&#x27;, &#x27; &#x27;, &#x27; &#x27;, &#x27;\t&#x27;, &#x27; &#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#\n与\t</span></span><br><span class="line"><span class="built_in">print</span>(re.findall(<span class="string">r&#x27;\n&#x27;</span>,<span class="string">&#x27;hello allen \n123&#x27;</span>)) <span class="comment">#[&#x27;\n&#x27;]</span></span><br><span class="line"><span class="built_in">print</span>(re.findall(<span class="string">r&#x27;\t&#x27;</span>,<span class="string">&#x27;hello allen\t123&#x27;</span>)) <span class="comment">#[&#x27;\n&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#\d与\D</span></span><br><span class="line"><span class="built_in">print</span>(re.findall(<span class="string">&#x27;\d&#x27;</span>,<span class="string">&#x27;hello allen 123&#x27;</span>)) <span class="comment">#[&#x27;1&#x27;, &#x27;2&#x27;, &#x27;3&#x27;]</span></span><br><span class="line"><span class="built_in">print</span>(re.findall(<span class="string">&#x27;\D&#x27;</span>,<span class="string">&#x27;hello allen 123&#x27;</span>)) <span class="comment">#[&#x27;h&#x27;, &#x27;e&#x27;, &#x27;l&#x27;, &#x27;l&#x27;, &#x27;o&#x27;, &#x27; &#x27;, &#x27;e&#x27;, &#x27;g&#x27;, &#x27;o&#x27;, &#x27;n&#x27;, &#x27; &#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#\A与\Z</span></span><br><span class="line"><span class="built_in">print</span>(re.findall(<span class="string">&#x27;\Ahe&#x27;</span>,<span class="string">&#x27;hello allen 123&#x27;</span>)) <span class="comment">#[&#x27;he&#x27;],\A==&gt;^</span></span><br><span class="line"><span class="built_in">print</span>(re.findall(<span class="string">&#x27;123\Z&#x27;</span>,<span class="string">&#x27;hello allen 123&#x27;</span>)) <span class="comment">#[&#x27;he&#x27;],\Z==&gt;$</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#^与$</span></span><br><span class="line"><span class="built_in">print</span>(re.findall(<span class="string">&#x27;^h&#x27;</span>,<span class="string">&#x27;hello allen 123&#x27;</span>)) <span class="comment">#[&#x27;h&#x27;]</span></span><br><span class="line"><span class="built_in">print</span>(re.findall(<span class="string">&#x27;3$&#x27;</span>,<span class="string">&#x27;hello allen 123&#x27;</span>)) <span class="comment">#[&#x27;3&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 重复匹配：| . | * | ? | .* | .*? | + | &#123;n,m&#125; |</span></span><br><span class="line"><span class="comment">#.</span></span><br><span class="line"><span class="built_in">print</span>(re.findall(<span class="string">&#x27;a.b&#x27;</span>,<span class="string">&#x27;a1b&#x27;</span>)) <span class="comment">#[&#x27;a1b&#x27;]</span></span><br><span class="line"><span class="built_in">print</span>(re.findall(<span class="string">&#x27;a.b&#x27;</span>,<span class="string">&#x27;a1b a*b a b aaab&#x27;</span>)) <span class="comment">#[&#x27;a1b&#x27;, &#x27;a*b&#x27;, &#x27;a b&#x27;, &#x27;aab&#x27;]</span></span><br><span class="line"><span class="built_in">print</span>(re.findall(<span class="string">&#x27;a.b&#x27;</span>,<span class="string">&#x27;a\nb&#x27;</span>)) <span class="comment">#[]</span></span><br><span class="line"><span class="built_in">print</span>(re.findall(<span class="string">&#x27;a.b&#x27;</span>,<span class="string">&#x27;a\nb&#x27;</span>,re.S)) <span class="comment">#[&#x27;a\nb&#x27;]</span></span><br><span class="line"><span class="built_in">print</span>(re.findall(<span class="string">&#x27;a.b&#x27;</span>,<span class="string">&#x27;a\nb&#x27;</span>,re.DOTALL)) <span class="comment">#[&#x27;a\nb&#x27;]同上一条意思一样</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#*</span></span><br><span class="line"><span class="built_in">print</span>(re.findall(<span class="string">&#x27;ab*&#x27;</span>,<span class="string">&#x27;bbbbbbb&#x27;</span>)) <span class="comment">#[]</span></span><br><span class="line"><span class="built_in">print</span>(re.findall(<span class="string">&#x27;ab*&#x27;</span>,<span class="string">&#x27;a&#x27;</span>)) <span class="comment">#[&#x27;a&#x27;]</span></span><br><span class="line"><span class="built_in">print</span>(re.findall(<span class="string">&#x27;ab*&#x27;</span>,<span class="string">&#x27;abbbb&#x27;</span>)) <span class="comment">#[&#x27;abbbb&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#?</span></span><br><span class="line"><span class="built_in">print</span>(re.findall(<span class="string">&#x27;ab?&#x27;</span>,<span class="string">&#x27;a&#x27;</span>)) <span class="comment">#[&#x27;a&#x27;]</span></span><br><span class="line"><span class="built_in">print</span>(re.findall(<span class="string">&#x27;ab?&#x27;</span>,<span class="string">&#x27;abbb&#x27;</span>)) <span class="comment">#[&#x27;ab&#x27;]</span></span><br><span class="line"><span class="comment">#匹配所有包含小数在内的数字</span></span><br><span class="line"><span class="built_in">print</span>(re.findall(<span class="string">&#x27;\d+\.?\d*&#x27;</span>,<span class="string">&quot;asdfasdf123as1.13dfa12adsf1asdf3&quot;</span>)) <span class="comment">#[&#x27;123&#x27;, &#x27;1.13&#x27;, &#x27;12&#x27;, &#x27;1&#x27;, &#x27;3&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#.*默认为贪婪匹配</span></span><br><span class="line"><span class="built_in">print</span>(re.findall(<span class="string">&#x27;a.*b&#x27;</span>,<span class="string">&#x27;a1b22222222b&#x27;</span>)) <span class="comment">#[&#x27;a1b22222222b&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#.*?为非贪婪匹配：推荐使用</span></span><br><span class="line"><span class="built_in">print</span>(re.findall(<span class="string">&#x27;a.*?b&#x27;</span>,<span class="string">&#x27;a1b22222222b&#x27;</span>)) <span class="comment">#[&#x27;a1b&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#+</span></span><br><span class="line"><span class="built_in">print</span>(re.findall(<span class="string">&#x27;ab+&#x27;</span>,<span class="string">&#x27;a&#x27;</span>)) <span class="comment">#[]</span></span><br><span class="line"><span class="built_in">print</span>(re.findall(<span class="string">&#x27;ab+&#x27;</span>,<span class="string">&#x27;abbb&#x27;</span>)) <span class="comment">#[&#x27;abbb&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#&#123;n,m&#125;</span></span><br><span class="line"><span class="built_in">print</span>(re.findall(<span class="string">&#x27;ab&#123;2&#125;&#x27;</span>,<span class="string">&#x27;abbb&#x27;</span>)) <span class="comment">#[&#x27;abb&#x27;]</span></span><br><span class="line"><span class="built_in">print</span>(re.findall(<span class="string">&#x27;ab&#123;2,4&#125;&#x27;</span>,<span class="string">&#x27;abbb&#x27;</span>)) <span class="comment">#[&#x27;abb&#x27;]</span></span><br><span class="line"><span class="built_in">print</span>(re.findall(<span class="string">&#x27;ab&#123;1,&#125;&#x27;</span>,<span class="string">&#x27;abbb&#x27;</span>)) <span class="comment">#&#x27;ab&#123;1,&#125;&#x27; ===&gt; &#x27;ab+&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(re.findall(<span class="string">&#x27;ab&#123;0,&#125;&#x27;</span>,<span class="string">&#x27;abbb&#x27;</span>)) <span class="comment">#&#x27;ab&#123;0,&#125;&#x27; ===&gt; &#x27;ab*&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#[]</span></span><br><span class="line"><span class="built_in">print</span>(re.findall(<span class="string">&#x27;a[1*-]b&#x27;</span>,<span class="string">&#x27;a1b a*b a-b&#x27;</span>)) <span class="comment">#[]内的都为普通字符了，且如果-没有被转意的话，应该放到[]的开头或结尾</span></span><br><span class="line"><span class="built_in">print</span>(re.findall(<span class="string">&#x27;a[^1*-]b&#x27;</span>,<span class="string">&#x27;a1b a*b a-b a=b&#x27;</span>)) <span class="comment">#[]内的^代表的意思是取反，所以结果为[&#x27;a=b&#x27;]</span></span><br><span class="line"><span class="built_in">print</span>(re.findall(<span class="string">&#x27;a[0-9]b&#x27;</span>,<span class="string">&#x27;a1b a*b a-b a=b&#x27;</span>)) <span class="comment">#[]内的^代表的意思是取反，所以结果为[&#x27;a=b&#x27;]</span></span><br><span class="line"><span class="built_in">print</span>(re.findall(<span class="string">&#x27;a[a-z]b&#x27;</span>,<span class="string">&#x27;a1b a*b a-b a=b aeb&#x27;</span>)) <span class="comment">#[]内的^代表的意思是取反，所以结果为[&#x27;a=b&#x27;]</span></span><br><span class="line"><span class="built_in">print</span>(re.findall(<span class="string">&#x27;a[a-zA-Z]b&#x27;</span>,<span class="string">&#x27;a1b a*b a-b a=b aeb aEb&#x27;</span>)) <span class="comment">#[]内的^代表的意思是取反，所以结果为[&#x27;a=b&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#\# print(re.findall(&#x27;a\\c&#x27;,&#x27;a\c&#x27;)) #对于正则来说a\\c确实可以匹配到a\c,但是在python解释器读取a\\c时，会发生转义，然后交给re去执行，所以抛出异常</span></span><br><span class="line"><span class="built_in">print</span>(re.findall(<span class="string">r&#x27;a\\c&#x27;</span>,<span class="string">&#x27;a\c&#x27;</span>)) <span class="comment">#r代表告诉解释器使用rawstring，即原生字符串，把我们正则内的所有符号都当普通字符处理，不要转义</span></span><br><span class="line"><span class="built_in">print</span>(re.findall(<span class="string">&#x27;a\\\\c&#x27;</span>,<span class="string">&#x27;a\c&#x27;</span>)) <span class="comment">#同上面的意思一样，和上面的结果一样都是[&#x27;a\\c&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#():分组</span></span><br><span class="line"><span class="built_in">print</span>(re.findall(<span class="string">&#x27;ab+&#x27;</span>,<span class="string">&#x27;ababab123&#x27;</span>)) <span class="comment">#[&#x27;ab&#x27;, &#x27;ab&#x27;, &#x27;ab&#x27;]</span></span><br><span class="line"><span class="built_in">print</span>(re.findall(<span class="string">&#x27;(ab)+123&#x27;</span>,<span class="string">&#x27;ababab123&#x27;</span>)) <span class="comment">#[&#x27;ab&#x27;]，匹配到末尾的ab123中的ab</span></span><br><span class="line"><span class="built_in">print</span>(re.findall(<span class="string">&#x27;(?:ab)+123&#x27;</span>,<span class="string">&#x27;ababab123&#x27;</span>)) <span class="comment">#findall的结果不是匹配的全部内容，而是组内的内容,?:可以让结果为匹配的全部内容</span></span><br><span class="line"><span class="built_in">print</span>(re.findall(<span class="string">&#x27;href=&quot;(.*?)&quot;&#x27;</span>,<span class="string">&#x27;&lt;a href=&quot;http://www.baidu.com&quot;&gt;点击&lt;/a&gt;&#x27;</span>))<span class="comment">#[&#x27;http://www.baidu.com&#x27;]</span></span><br><span class="line"><span class="built_in">print</span>(re.findall(<span class="string">&#x27;href=&quot;(?:.*?)&quot;&#x27;</span>,<span class="string">&#x27;&lt;a href=&quot;http://www.baidu.com&quot;&gt;点击&lt;/a&gt;&#x27;</span>))<span class="comment">#[&#x27;href=&quot;http://www.baidu.com&quot;&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#|</span></span><br><span class="line"><span class="built_in">print</span>(re.findall(<span class="string">&#x27;compan(?:y|ies)&#x27;</span>,<span class="string">&#x27;Too many companies have gone bankrupt, and the next one is my company&#x27;</span>))</span><br></pre></td></tr></table></figure><p></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ===========================re模块提供的方法介绍===========================</span></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="comment">#1</span></span><br><span class="line"><span class="built_in">print</span>(re.findall(<span class="string">&#x27;e&#x27;</span>,<span class="string">&#x27;alex make love&#x27;</span>) )   <span class="comment">#[&#x27;e&#x27;, &#x27;e&#x27;, &#x27;e&#x27;],返回所有满足匹配条件的结果,放在列表里</span></span><br><span class="line"><span class="comment">#2</span></span><br><span class="line"><span class="built_in">print</span>(re.search(<span class="string">&#x27;e&#x27;</span>,<span class="string">&#x27;alex make love&#x27;</span>).group()) <span class="comment">#e,只到找到第一个匹配然后返回一个包含匹配信息的对象,该对象可以通过调用group()方法得到匹配的字符串,如果字符串没有匹配，则返回None。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#3</span></span><br><span class="line"><span class="built_in">print</span>(re.match(<span class="string">&#x27;e&#x27;</span>,<span class="string">&#x27;alex make love&#x27;</span>))    <span class="comment">#None,同search,不过在字符串开始处进行匹配,完全可以用search+^代替match</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#4</span></span><br><span class="line"><span class="built_in">print</span>(re.split(<span class="string">&#x27;[ab]&#x27;</span>,<span class="string">&#x27;abcd&#x27;</span>))     <span class="comment">#[&#x27;&#x27;, &#x27;&#x27;, &#x27;cd&#x27;]，先按&#x27;a&#x27;分割得到&#x27;&#x27;和&#x27;bcd&#x27;,再对&#x27;&#x27;和&#x27;bcd&#x27;分别按&#x27;b&#x27;分割</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#5</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;===&gt;&#x27;</span>,re.sub(<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;A&#x27;</span>,<span class="string">&#x27;alex make love&#x27;</span>)) <span class="comment">#===&gt; Alex mAke love，不指定n，默认替换所有</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;===&gt;&#x27;</span>,re.sub(<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;A&#x27;</span>,<span class="string">&#x27;alex make love&#x27;</span>,<span class="number">1</span>)) <span class="comment">#===&gt; Alex make love</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;===&gt;&#x27;</span>,re.sub(<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;A&#x27;</span>,<span class="string">&#x27;alex make love&#x27;</span>,<span class="number">2</span>)) <span class="comment">#===&gt; Alex mAke love</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;===&gt;&#x27;</span>,re.sub(<span class="string">&#x27;^(\w+)(.*?\s)(\w+)(.*?\s)(\w+)(.*?)$&#x27;</span>,<span class="string">r&#x27;\5\2\3\4\1&#x27;</span>,<span class="string">&#x27;alex make love&#x27;</span>)) <span class="comment">#===&gt; love make alex</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;===&gt;&#x27;</span>,re.subn(<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;A&#x27;</span>,<span class="string">&#x27;alex make love&#x27;</span>)) <span class="comment">#===&gt; (&#x27;Alex mAke love&#x27;, 2),结果带有总共替换的个数</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#6</span></span><br><span class="line">obj=re.<span class="built_in">compile</span>(<span class="string">&#x27;\d&#123;2&#125;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(obj.search(<span class="string">&#x27;abc123eeee&#x27;</span>).group()) <span class="comment">#12</span></span><br><span class="line"><span class="built_in">print</span>(obj.findall(<span class="string">&#x27;abc123eeee&#x27;</span>)) <span class="comment">#[&#x27;12&#x27;],重用了obj</span></span><br></pre></td></tr></table></figure><p><code>补充</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 补充一</span></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="built_in">print</span>(re.findall(<span class="string">&quot;&lt;(?P&lt;tag_name&gt;\w+)&gt;\w+&lt;/(?P=tag_name)&gt;&quot;</span>,<span class="string">&quot;&lt;h1&gt;hello&lt;/h1&gt;&quot;</span>)) <span class="comment">#[&#x27;h1&#x27;]</span></span><br><span class="line"><span class="built_in">print</span>(re.search(<span class="string">&quot;&lt;(?P&lt;tag_name&gt;\w+)&gt;\w+&lt;/(?P=tag_name)&gt;&quot;</span>,<span class="string">&quot;&lt;h1&gt;hello&lt;/h1&gt;&quot;</span>).group()) <span class="comment">#&lt;h1&gt;hello&lt;/h1&gt;</span></span><br><span class="line"><span class="built_in">print</span>(re.search(<span class="string">&quot;&lt;(?P&lt;tag_name&gt;\w+)&gt;\w+&lt;/(?P=tag_name)&gt;&quot;</span>,<span class="string">&quot;&lt;h1&gt;hello&lt;/h1&gt;&quot;</span>).groupdict()) <span class="comment">#&lt;h1&gt;hello&lt;/h1&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(re.search(<span class="string">r&quot;&lt;(\w+)&gt;\w+&lt;/(\w+)&gt;&quot;</span>,<span class="string">&quot;&lt;h1&gt;hello&lt;/h1&gt;&quot;</span>).group())</span><br><span class="line"><span class="built_in">print</span>(re.search(<span class="string">r&quot;&lt;(\w+)&gt;\w+&lt;/\1&gt;&quot;</span>,<span class="string">&quot;&lt;h1&gt;hello&lt;/h1&gt;&quot;</span>).group())</span><br><span class="line"></span><br><span class="line"><span class="comment">#补充二</span></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="comment">#使用|，先匹配的先生效，|左边是匹配小数，而findall最终结果是查看分组，所有即使匹配成功小数也不会存入结果</span></span><br><span class="line"><span class="comment">#而不是小数时，就去匹配(-?\d+)，匹配到的自然就是，非小数的数，在此处即整数</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="built_in">print</span>(re.findall(<span class="string">r&quot;-?\d+\.\d*|(-?\d+)&quot;</span>,<span class="string">&quot;1-2*(60+(-40.35/5)-(-4*3))&quot;</span>)) <span class="comment">#找出所有整数[&#x27;1&#x27;, &#x27;-2&#x27;, &#x27;60&#x27;, &#x27;&#x27;, &#x27;5&#x27;, &#x27;-4&#x27;, &#x27;3&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#找到所有数字:</span></span><br><span class="line"><span class="built_in">print</span>(re.findall(<span class="string">&#x27;\D?(\-?\d+\.?\d*)&#x27;</span>,<span class="string">&quot;1-2*(60+(-40.35/5)-(-4*3))&quot;</span>)) <span class="comment"># [&#x27;1&#x27;,&#x27;2&#x27;,&#x27;60&#x27;,&#x27;-40.35&#x27;,&#x27;5&#x27;,&#x27;-4&#x27;,&#x27;3&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#计算器作业参考：http://www.cnblogs.com/wupeiqi/articles/4949995.html</span></span><br><span class="line">expression=<span class="string">&#x27;1-2*((60+2*(-3-40.0/5)*(9-2*5/3+7/3*99/4*2998+10*568/14))-(-4*3)/(16-3*2))&#x27;</span></span><br><span class="line"></span><br><span class="line">content=re.search(<span class="string">&#x27;\(([\-\+\*\/]*\d+\.?\d*)+\)&#x27;</span>,expression).group() <span class="comment">#(-3-40.0/5)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>search与findall</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#为何同样的表达式search与findall却有不同结果:</span></span><br><span class="line"><span class="built_in">print</span>(re.search(<span class="string">&#x27;\(([\+\-\*\/]*\d+\.?\d*)+\)&#x27;</span>,<span class="string">&quot;1-12*(60+(-40.35/5)-(-4*3))&quot;</span>).group()) <span class="comment">#(-40.35/5)</span></span><br><span class="line"><span class="built_in">print</span>(re.findall(<span class="string">&#x27;\(([\+\-\*\/]*\d+\.?\d*)+\)&#x27;</span>,<span class="string">&quot;1-12*(60+(-40.35/5)-(-4*3))&quot;</span>)) <span class="comment">#[&#x27;/5&#x27;, &#x27;*3&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#看这个例子:(\d)+相当于(\d)(\d)(\d)(\d)...,是一系列分组</span></span><br><span class="line"><span class="built_in">print</span>(re.search(<span class="string">&#x27;(\d)+&#x27;</span>,<span class="string">&#x27;123&#x27;</span>).group()) <span class="comment">#group的作用是将所有组拼接到一起显示出来</span></span><br><span class="line"><span class="built_in">print</span>(re.findall(<span class="string">&#x27;(\d)+&#x27;</span>,<span class="string">&#x27;123&#x27;</span>)) <span class="comment">#findall结果是组内的结果,且是最后一个组的结果</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#_*_coding:utf-8_*_</span></span><br><span class="line">__author__ = <span class="string">&#x27;Linhaifeng&#x27;</span></span><br><span class="line"><span class="comment">#在线调试工具:tool.oschina.net/regex/#</span></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">s=<span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">http://www.baidu.com</span></span><br><span class="line"><span class="string">egon@oldboyedu.com</span></span><br><span class="line"><span class="string">你好</span></span><br><span class="line"><span class="string">010-3141</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#最常规匹配</span></span><br><span class="line">content=<span class="string">&#x27;Hello 123 456 World_This is a Regex Demo&#x27;</span></span><br><span class="line">res=re.match(<span class="string">&#x27;Hello\s\d\d\d\s\d&#123;3&#125;\s\w&#123;10&#125;.*Demo&#x27;</span>,content)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"><span class="built_in">print</span>(res.group())</span><br><span class="line"><span class="built_in">print</span>(res.span())</span><br><span class="line"></span><br><span class="line"><span class="comment">#泛匹配</span></span><br><span class="line">content=<span class="string">&#x27;Hello 123 456 World_This is a Regex Demo&#x27;</span></span><br><span class="line">res=re.match(<span class="string">&#x27;^Hello.*Demo&#x27;</span>,content)</span><br><span class="line"><span class="built_in">print</span>(res.group())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#匹配目标,获得指定数据</span></span><br><span class="line"></span><br><span class="line">content=<span class="string">&#x27;Hello 123 456 World_This is a Regex Demo&#x27;</span></span><br><span class="line">res=re.match(<span class="string">&#x27;^Hello\s(\d+)\s(\d+)\s.*Demo&#x27;</span>,content)</span><br><span class="line"><span class="built_in">print</span>(res.group()) <span class="comment">#取所有匹配的内容</span></span><br><span class="line"><span class="built_in">print</span>(res.group(<span class="number">1</span>)) <span class="comment">#取匹配的第一个括号内的内容</span></span><br><span class="line"><span class="built_in">print</span>(res.group(<span class="number">2</span>)) <span class="comment">#去陪陪的第二个括号内的内容</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#贪婪匹配:.*代表匹配尽可能多的字符</span></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">content=<span class="string">&#x27;Hello 123 456 World_This is a Regex Demo&#x27;</span></span><br><span class="line"></span><br><span class="line">res=re.match(<span class="string">&#x27;^He.*(\d+).*Demo$&#x27;</span>,content)</span><br><span class="line"><span class="built_in">print</span>(res.group(<span class="number">1</span>)) <span class="comment">#只打印6,因为.*会尽可能多的匹配,然后后面跟至少一个数字</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#非贪婪匹配:?匹配尽可能少的字符</span></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">content=<span class="string">&#x27;Hello 123 456 World_This is a Regex Demo&#x27;</span></span><br><span class="line"></span><br><span class="line">res=re.match(<span class="string">&#x27;^He.*?(\d+).*Demo$&#x27;</span>,content)</span><br><span class="line"><span class="built_in">print</span>(res.group(<span class="number">1</span>)) <span class="comment">#只打印6,因为.*会尽可能多的匹配,然后后面跟至少一个数字</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#匹配模式:.不能匹配换行符</span></span><br><span class="line">content=<span class="string">&#x27;&#x27;&#x27;Hello 123456 World_This</span></span><br><span class="line"><span class="string">is a Regex Demo</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">res=re.match(<span class="string">&#x27;He.*?(\d+).*?Demo$&#x27;</span>,content)</span><br><span class="line"><span class="built_in">print</span>(res) <span class="comment">#输出None</span></span><br><span class="line"></span><br><span class="line">res=re.match(<span class="string">&#x27;He.*?(\d+).*?Demo$&#x27;</span>,content,re.S) <span class="comment">#re.S让.可以匹配换行符</span></span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"><span class="built_in">print</span>(res.group(<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#转义:\</span></span><br><span class="line"></span><br><span class="line">content=<span class="string">&#x27;price is $5.00&#x27;</span></span><br><span class="line">res=re.match(<span class="string">&#x27;price is $5.00&#x27;</span>,content)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"></span><br><span class="line">res=re.match(<span class="string">&#x27;price is \$5\.00&#x27;</span>,content)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#总结:尽量精简,详细的如下</span></span><br><span class="line">    <span class="comment"># 尽量使用泛匹配模式.*</span></span><br><span class="line">    <span class="comment"># 尽量使用非贪婪模式:.*?</span></span><br><span class="line">    <span class="comment"># 使用括号得到匹配目标:用group(n)去取得结果</span></span><br><span class="line">    <span class="comment"># 有换行符就用re.S:修改模式</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#re.search:会扫描整个字符串,不会从头开始,找到第一个匹配的结果就会返回</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">content=<span class="string">&#x27;Extra strings Hello 123 456 World_This is a Regex Demo Extra strings&#x27;</span></span><br><span class="line"></span><br><span class="line">res=re.match(<span class="string">&#x27;Hello.*?(\d+).*?Demo&#x27;</span>,content)</span><br><span class="line"><span class="built_in">print</span>(res) <span class="comment">#输出结果为None</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">content=<span class="string">&#x27;Extra strings Hello 123 456 World_This is a Regex Demo Extra strings&#x27;</span></span><br><span class="line"></span><br><span class="line">res=re.search(<span class="string">&#x27;Hello.*?(\d+).*?Demo&#x27;</span>,content) <span class="comment">#</span></span><br><span class="line"><span class="built_in">print</span>(res.group(<span class="number">1</span>)) <span class="comment">#输出结果为</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#re.search:只要一个结果,匹配演练,</span></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">content=<span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">&lt;tbody&gt;</span></span><br><span class="line"><span class="string">&lt;tr id=&quot;4766303201494371851675&quot; class=&quot;even &quot;&gt;&lt;td&gt;&lt;div class=&quot;hd&quot;&gt;&lt;span class=&quot;num&quot;&gt;1&lt;/span&gt;&lt;div class=&quot;rk &quot;&gt;&lt;span class=&quot;u-icn u-icn-75&quot;&gt;&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class=&quot;rank&quot;&gt;&lt;div class=&quot;f-cb&quot;&gt;&lt;div class=&quot;tt&quot;&gt;&lt;a href=&quot;/song?id=476630320&quot;&gt;&lt;img class=&quot;rpic&quot; src=&quot;http://p1.music.126.net/Wl7T1LBRhZFg0O26nnR2iQ==/19217264230385030.jpg?param=50y50&amp;amp;quality=100&quot;&gt;&lt;/a&gt;&lt;span data-res-id=&quot;476630320&quot; &quot;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">res=re.search(<span class="string">&#x27;&lt;a\shref=.*?&lt;b\stitle=&quot;(.*?)&quot;.*?b&gt;&#x27;</span>,content)</span><br><span class="line"><span class="built_in">print</span>(res.group(<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#re.findall:找到符合条件的所有结果</span></span><br><span class="line">res=re.findall(<span class="string">&#x27;&lt;a\shref=.*?&lt;b\stitle=&quot;(.*?)&quot;.*?b&gt;&#x27;</span>,content)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> res:</span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#re.sub:字符串替换</span></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">content=<span class="string">&#x27;Extra strings Hello 123 456 World_This is a Regex Demo Extra strings&#x27;</span></span><br><span class="line"></span><br><span class="line">content=re.sub(<span class="string">&#x27;\d+&#x27;</span>,<span class="string">&#x27;&#x27;</span>,content)</span><br><span class="line"><span class="built_in">print</span>(content)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#用\1取得第一个括号的内容</span></span><br><span class="line"><span class="comment">#用法:将123与456换位置</span></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">content=<span class="string">&#x27;Extra strings Hello 123 456 World_This is a Regex Demo Extra strings&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># content=re.sub(&#x27;(Extra.*?)(\d+)(\s)(\d+)(.*?strings)&#x27;,r&#x27;\1\4\3\2\5&#x27;,content)</span></span><br><span class="line">content=re.sub(<span class="string">&#x27;(\d+)(\s)(\d+)&#x27;</span>,<span class="string">r&#x27;\3\2\1&#x27;</span>,content)</span><br><span class="line"><span class="built_in">print</span>(content)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">content=<span class="string">&#x27;Extra strings Hello 123 456 World_This is a Regex Demo Extra strings&#x27;</span></span><br><span class="line"></span><br><span class="line">res=re.search(<span class="string">&#x27;Extra.*?(\d+).*strings&#x27;</span>,content)</span><br><span class="line"><span class="built_in">print</span>(res.group(<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests,re</span><br><span class="line">respone=requests.get(<span class="string">&#x27;https://book.douban.com/&#x27;</span>).text</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(respone)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;======&#x27;</span>*<span class="number">1000</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;======&#x27;</span>*<span class="number">1000</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;======&#x27;</span>*<span class="number">1000</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;======&#x27;</span>*<span class="number">1000</span>)</span><br><span class="line">res=re.findall(<span class="string">&#x27;&lt;li.*?cover.*?href=&quot;(.*?)&quot;.*?title=&quot;(.*?)&quot;&gt;.*?more-meta.*?author&quot;&gt;(.*?)&lt;/span.*?year&quot;&gt;(.*?)&lt;/span.*?publisher&quot;&gt;(.*?)&lt;/span.*?&lt;/li&gt;&#x27;</span>,respone,re.S)</span><br><span class="line"><span class="comment"># res=re.findall(&#x27;&lt;li.*?cover.*?href=&quot;(.*?)&quot;.*?more-meta.*?author&quot;&gt;(.*?)&lt;/span.*?year&quot;&gt;(.*?)&lt;/span.*?publisher&quot;&gt;(.*?)&lt;/span&gt;.*?&lt;/li&gt;&#x27;,respone,re.S)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> res:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;%s    %s    %s   %s&#x27;</span> %(i[<span class="number">0</span>].strip(),i[<span class="number">1</span>].strip(),i[<span class="number">2</span>].strip(),i[<span class="number">3</span>].strip()))</span><br></pre></td></tr></table></figure></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者:</span> <span class="post-copyright-info"><a href="https://moyand.gitee.io">JerryWang</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接:</span> <span class="post-copyright-info"><a href="https://moyand.gitee.io/2019/11/27/Python/Python%E4%B9%8B%E6%97%85/Python%E4%B9%8B%E6%97%85%EF%BC%9A%E5%B8%B8%E7%94%A8%E6%A8%A1%E5%9D%97/">https://moyand.gitee.io/2019/11/27/Python/Python之旅/Python之旅：常用模块/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明:</span> <span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://moyand.gitee.io" target="_blank">JerryWang</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E6%A8%A1%E5%9D%97/">模块</a></div><div class="post_share"><div class="social-share" data-image="https://moyand.gitee.io/2019/11/27/Python/Python之旅/Python之旅：常用模块/top.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/gh/overtrue/share.js@master/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.jpg" target="_blank"><img class="post-qr-code-img" src="/img/wechat.jpg" alt="微信"></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/img/alipay.jpg" target="_blank"><img class="post-qr-code-img" src="/img/alipay.jpg" alt="支付宝"></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2019/11/28/Python/Python%E4%B9%8B%E6%97%85/Python%E4%B9%8B%E6%97%85%EF%BC%9A%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/"><img class="prev-cover" src="https://moyand.gitee.io/2019/11/28/Python/Python之旅/Python之旅：面向对象/view.jpg" onerror='onerror=null,src="/img/404.jpg"' alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Python之旅：面向对象</div></div></a></div><div class="next-post pull-right"><a href="/2019/11/27/Python/Python%E4%B9%8B%E6%97%85/Python%E4%B9%8B%E6%97%85%EF%BC%9A%E6%A8%A1%E5%9D%97%E4%B8%8E%E5%8C%85/"><img class="next-cover" src="https://moyand.gitee.io/2019/11/27/Python/Python之旅/Python之旅：模块与包/view.png" onerror='onerror=null,src="/img/404.jpg"' alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Python之旅：模块与包和目录规范</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2021/07/07/Python/%E5%A5%87%E9%97%BB%E6%9D%82%E8%B0%88/python%E4%B8%8BSimpleHTTPServer%E7%94%A8%E6%B3%95/" title="快速生成web服务器http.server模块"><img class="cover" src="https://moyand.gitee.io/2019/11/27/Python/Python之旅/Python之旅：常用模块/top.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-07-07</div><div class="title">快速生成web服务器http.server模块</div></div></a></div><div><a href="/2020/06/20/Python/%E5%A5%87%E9%97%BB%E6%9D%82%E8%B0%88/%E7%94%A8openpyxl%E8%AF%BB%E5%86%99Excel%E6%96%87%E4%BB%B6/" title="用openpyxl读写Excel文件"><img class="cover" src="https://moyand.gitee.io/2019/11/27/Python/Python之旅/Python之旅：常用模块/top.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-06-20</div><div class="title">用openpyxl读写Excel文件</div></div></a></div><div><a href="/2019/11/27/Python/Python%E4%B9%8B%E6%97%85/Python%E4%B9%8B%E6%97%85%EF%BC%9A%E6%A8%A1%E5%9D%97%E4%B8%8E%E5%8C%85/" title="Python之旅：模块与包和目录规范"><img class="cover" src="https://moyand.gitee.io/2019/11/27/Python/Python之旅/Python之旅：模块与包/view.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2019-11-27</div><div class="title">Python之旅：模块与包和目录规范</div></div></a></div></div></div><hr><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i> <span>评论</span></div></div><div class="comment-wrap"><div><div id="lv-container" data-id="city" data-uid="MTAyMC80NTg2Ni8yMjM3Nw"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/avatar.png" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="avatar"></div><div class="author-info__name">JerryWang</div><div class="author-info__description">再牛逼的梦想，也抵不过傻逼一样的坚持！</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">130</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">88</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">26</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://jerrrywang.github.io"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/JerrryWang" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:wjy_0316@126.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="https://weibo.com/allenaq/" target="_blank" title="WeiBo"><i class="fab fa-zhihu"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;低级的欲望,放纵即可获得<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;高级的欲望,克制才能得到</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#time%E4%B8%8Edatetime%E6%A8%A1%E5%9D%97"><span class="toc-number">1.</span> <span class="toc-text">time与datetime模块</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#random%E6%A8%A1%E5%9D%97"><span class="toc-number">2.</span> <span class="toc-text">random模块</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#os%E6%A8%A1%E5%9D%97"><span class="toc-number">3.</span> <span class="toc-text">os模块</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#python%E8%B0%83%E7%94%A8Shell%E8%84%9A%E6%9C%AC"><span class="toc-number">3.1.</span> <span class="toc-text">python调用Shell脚本</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#sys%E6%A8%A1%E5%9D%97"><span class="toc-number">4.</span> <span class="toc-text">sys模块</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#shutil%E6%A8%A1%E5%9D%97"><span class="toc-number">5.</span> <span class="toc-text">shutil模块</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#json-amp-pickle%E6%A8%A1%E5%9D%97"><span class="toc-number">6.</span> <span class="toc-text">json&amp;pickle模块</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E5%BA%8F%E5%88%97%E5%8C%96%EF%BC%9F"><span class="toc-number">6.1.</span> <span class="toc-text">什么是序列化？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E5%BA%8F%E5%88%97%E5%8C%96%EF%BC%9F"><span class="toc-number">6.2.</span> <span class="toc-text">为什么要序列化？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#json"><span class="toc-number">6.3.</span> <span class="toc-text">json</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#pickle"><span class="toc-number">6.4.</span> <span class="toc-text">pickle</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#json-amp-pickle-%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">6.5.</span> <span class="toc-text">json&amp;pickle 的区别</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#shelve%E6%A8%A1%E5%9D%97"><span class="toc-number">7.</span> <span class="toc-text">shelve模块</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#xml%E6%A8%A1%E5%9D%97"><span class="toc-number">8.</span> <span class="toc-text">xml模块</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#configparser%E6%A8%A1%E5%9D%97"><span class="toc-number">9.</span> <span class="toc-text">configparser模块</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%BB%E5%8F%96"><span class="toc-number">9.1.</span> <span class="toc-text">读取</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%94%B9%E5%86%99"><span class="toc-number">9.2.</span> <span class="toc-text">改写</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#hashlib%E6%A8%A1%E5%9D%97"><span class="toc-number">10.</span> <span class="toc-text">hashlib模块</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#suprocess%E6%A8%A1%E5%9D%97"><span class="toc-number">11.</span> <span class="toc-text">suprocess模块</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#logging%E6%A8%A1%E5%9D%97"><span class="toc-number">12.</span> <span class="toc-text">logging模块</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A5%E5%BF%97%E7%BA%A7%E5%88%AB"><span class="toc-number">12.1.</span> <span class="toc-text">日志级别</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%BB%98%E8%AE%A4%E7%BA%A7%E5%88%AB%E4%B8%BAwarning%EF%BC%8C%E9%BB%98%E8%AE%A4%E6%89%93%E5%8D%B0%E5%88%B0%E7%BB%88%E7%AB%AF"><span class="toc-number">12.2.</span> <span class="toc-text">默认级别为warning，默认打印到终端</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%BAlogging%E6%A8%A1%E5%9D%97%E6%8C%87%E5%AE%9A%E5%85%A8%E5%B1%80%E9%85%8D%E7%BD%AE%EF%BC%8C%E9%92%88%E5%AF%B9%E6%89%80%E6%9C%89logger%E6%9C%89%E6%95%88%EF%BC%8C%E6%8E%A7%E5%88%B6%E6%89%93%E5%8D%B0%E5%88%B0%E6%96%87%E4%BB%B6%E4%B8%AD"><span class="toc-number">12.3.</span> <span class="toc-text">为logging模块指定全局配置，针对所有logger有效，控制打印到文件中</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#logging%E6%A8%A1%E5%9D%97%E7%9A%84Formatter%EF%BC%8CHandler%EF%BC%8CLogger%EF%BC%8CFilter%E5%AF%B9%E8%B1%A1"><span class="toc-number">12.4.</span> <span class="toc-text">logging模块的Formatter，Handler，Logger，Filter对象</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Logger%E4%B8%8EHandler%E7%9A%84%E7%BA%A7%E5%88%AB"><span class="toc-number">12.5.</span> <span class="toc-text">Logger与Handler的级别</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Logger%E7%9A%84%E7%BB%A7%E6%89%BF%EF%BC%88%E4%BA%86%E8%A7%A3%EF%BC%89"><span class="toc-number">12.6.</span> <span class="toc-text">Logger的继承（了解）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BA%94%E7%94%A8"><span class="toc-number">12.7.</span> <span class="toc-text">应用</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#re%E6%A8%A1%E5%9D%97"><span class="toc-number">13.</span> <span class="toc-text">re模块</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%EF%BC%9A%E4%BB%80%E4%B9%88%E6%98%AF%E6%AD%A3%E5%88%99%EF%BC%9F"><span class="toc-number">13.1.</span> <span class="toc-text">一：什么是正则？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%EF%BC%9A%E5%B8%B8%E7%94%A8%E5%8C%B9%E9%85%8D%E6%A8%A1%E5%BC%8F-%E5%85%83%E5%AD%97%E7%AC%A6"><span class="toc-number">13.2.</span> <span class="toc-text">二：常用匹配模式(元字符)</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/07/13/Python/%E6%A8%A1%E5%9D%97/loguru%E6%97%A5%E5%BF%97%E7%AE%A1%E7%90%86/" title="loguru日志模块的使用"><img src="https://jerrrywang.github.io/2018/10/11/photo/ming_3.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="loguru日志模块的使用"></a><div class="content"><a class="title" href="/2022/07/13/Python/%E6%A8%A1%E5%9D%97/loguru%E6%97%A5%E5%BF%97%E7%AE%A1%E7%90%86/" title="loguru日志模块的使用">loguru日志模块的使用</a><time datetime="2022-07-13T01:10:19.000Z" title="发表于 2022-07-13 09:10:19">2022-07-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/07/13/Python/%E6%A8%A1%E5%9D%97/tarfile%E6%A8%A1%E5%9D%97/" title="tarfile压缩模块的使用"><img src="https://jerrrywang.github.io/2018/10/11/photo/ming_10.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="tarfile压缩模块的使用"></a><div class="content"><a class="title" href="/2022/07/13/Python/%E6%A8%A1%E5%9D%97/tarfile%E6%A8%A1%E5%9D%97/" title="tarfile压缩模块的使用">tarfile压缩模块的使用</a><time datetime="2022-07-13T01:10:19.000Z" title="发表于 2022-07-13 09:10:19">2022-07-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/07/12/Python/%E6%A8%A1%E5%9D%97/python%E7%BB%99%E5%9B%BE%E7%89%87%E6%89%B9%E9%87%8F%E6%B7%BB%E5%8A%A0%E6%B0%B4%E5%8D%B0filestools%E6%A8%A1%E5%9D%97/" title="python给图片批量添加水印filestools模块"><img src="https://jerrrywang.github.io/2018/10/11/photo/ming_8.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="python给图片批量添加水印filestools模块"></a><div class="content"><a class="title" href="/2022/07/12/Python/%E6%A8%A1%E5%9D%97/python%E7%BB%99%E5%9B%BE%E7%89%87%E6%89%B9%E9%87%8F%E6%B7%BB%E5%8A%A0%E6%B0%B4%E5%8D%B0filestools%E6%A8%A1%E5%9D%97/" title="python给图片批量添加水印filestools模块">python给图片批量添加水印filestools模块</a><time datetime="2022-07-12T01:00:19.000Z" title="发表于 2022-07-12 09:00:19">2022-07-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/06/18/Python/%E6%A8%A1%E5%9D%97/python%E6%9F%A5%E6%89%BE%E6%96%87%E4%BB%B6filestools%E3%80%81glob%E6%A8%A1%E5%9D%97/" title="python查找文件fnmatch、glob模块"><img src="https://jerrrywang.github.io/2018/10/11/photo/ming_9.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="python查找文件fnmatch、glob模块"></a><div class="content"><a class="title" href="/2022/06/18/Python/%E6%A8%A1%E5%9D%97/python%E6%9F%A5%E6%89%BE%E6%96%87%E4%BB%B6filestools%E3%80%81glob%E6%A8%A1%E5%9D%97/" title="python查找文件fnmatch、glob模块">python查找文件fnmatch、glob模块</a><time datetime="2022-06-18T01:00:19.000Z" title="发表于 2022-06-18 09:00:19">2022-06-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/03/30/%E6%95%99%E7%A8%8B/Anaconda%E5%AE%89%E8%A3%85%E5%8F%8A%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/" title="Anaconda安装及使用教程"><img src="https://jerrrywang.github.io/2018/10/11/photo/ming_5.jpeg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="Anaconda安装及使用教程"></a><div class="content"><a class="title" href="/2022/03/30/%E6%95%99%E7%A8%8B/Anaconda%E5%AE%89%E8%A3%85%E5%8F%8A%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/" title="Anaconda安装及使用教程">Anaconda安装及使用教程</a><time datetime="2022-03-30T07:10:35.000Z" title="发表于 2022-03-30 15:10:35">2022-03-30</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By JerryWang</div><div class="footer_custom_text"><a target="_blank" rel="noopener" href="https://jerrrywang.github.io">生活要像水墨画一样的浓厚多姿</a>!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="algolia-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="search-wrap"><div id="algolia-search-input"></div><hr><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-info"><div class="algolia-stats"></div><div class="algolia-poweredBy"></div></div></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script>function panguFn(){"object"==typeof pangu?pangu.autoSpacingPage():getScript("https://cdn.jsdelivr.net/npm/pangu@4/dist/browser/pangu.min.js").then(()=>{pangu.autoSpacingPage()})}function panguInit(){GLOBAL_CONFIG_SITE.isPost&&panguFn()}document.addEventListener("DOMContentLoaded",panguInit)</script><script src="https://cdn.jsdelivr.net/npm/algoliasearch@4/dist/algoliasearch-lite.umd.js"></script><script src="https://cdn.jsdelivr.net/npm/instantsearch.js@4/dist/instantsearch.production.min.js"></script><script src="/js/search/algolia.js"></script><script>var preloader={endLoading:()=>{document.body.style.overflow="auto",document.getElementById("loading-box").classList.add("loaded")},initLoading:()=>{document.body.style.overflow="",document.getElementById("loading-box").classList.remove("loaded")}};window.addEventListener("load",preloader.endLoading())</script><div class="js-pjax"><script>function loadLivere(){var e,t,o,r;"object"==typeof LivereTower?window.LivereTower.init():(e=document,t="script",r=e.getElementsByTagName(t)[0],"function"!=typeof LivereTower&&((o=e.createElement(t)).src="https://cdn-city.livere.com/js/embed.dist.js",o.async=!0,r.parentNode.insertBefore(o,r)))}{function loadOtherComment(){loadLivere()}loadLivere()}</script></div><div class="aplayer no-destroy" data-id="60198" data-server="netease" data-type="playlist" data-fixed="true" data-autoplay="true" data-order="random"></div><script id="canvas_nest" defer color="0,0,255" opacity="0.7" zindex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-nest.min.js"></script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/click-show-text.min.js" data-mobile="false" data-text="I,LOVE,YOU,JerryWang,超帥,富强,民主,文明,和谐,自由,平等,公正,法治,爱国,敬业,诚信,友善" data-fontsize="15px" data-random="true" async></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1/dist/APlayer.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/aplayer@1/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/gh/metowolf/MetingJS@1.2/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors=['meta[property="og:image"]','meta[property="og:title"]','meta[property="og:url"]',"head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"];var pjax=new Pjax({elements:'a:not([target="_blank"]):not([href="/music/"]):not([href="/no-pjax/"])',selectors:pjaxSelectors,cacheBust:!1,analytics:!1,scrollRestoration:!1});document.addEventListener("pjax:send",(function(){if(window.tocScrollFn&&window.removeEventListener("scroll",window.tocScrollFn),window.scrollCollect&&window.removeEventListener("scroll",scrollCollect),"object"==typeof preloader&&preloader.initLoading(),document.getElementById("rightside").style.cssText="opacity: ''; transform: ''",window.aplayers)for(let e=0;e<window.aplayers.length;e++)window.aplayers[e].options.fixed||window.aplayers[e].destroy();"object"==typeof typed&&typed.destroy();const e=document.body.classList;e.contains("read-mode")&&e.remove("read-mode")})),document.addEventListener("pjax:complete",(function(){window.refreshFn(),document.querySelectorAll("script[data-pjax]").forEach(e=>{const t=document.createElement("script"),o=e.text||e.textContent||e.innerHTML||"";Array.from(e.attributes).forEach(e=>t.setAttribute(e.name,e.value)),t.appendChild(document.createTextNode(o)),e.parentNode.replaceChild(t,e)}),GLOBAL_CONFIG.islazyload&&window.lazyLoadInstance.update(),"function"==typeof chatBtnFn&&chatBtnFn(),"function"==typeof panguInit&&panguInit(),"function"==typeof gtag&&gtag("config","",{page_path:window.location.pathname}),"object"==typeof _hmt&&_hmt.push(["_trackPageview",window.location.pathname]),"function"==typeof loadMeting&&document.getElementsByClassName("aplayer").length&&loadMeting(),"object"==typeof Prism&&Prism.highlightAll(),"object"==typeof preloader&&preloader.endLoading()})),document.addEventListener("pjax:error",e=>{404===e.request.status&&pjax.loadUrl("/404.html")})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script>var font="Ringing"</script><script data-pjax>function electric_clock_injector_config(){var c=document.getElementsByClassName("sticky_layout")[0];console.log("已挂载electric_clock"),c.insertAdjacentHTML("afterbegin",'<div class="card-widget card-clock"><div class="card-glass"><div class="card-background"><div class="card-content"><div id="hexo_electric_clock"><img id="card-clock-loading" src="https://moyand.gitee.io/api/shubiao/loading.gif" style="height: 120px; width: 100%;" data-ll-status="loading" class="entered loading"></div></div></div></div></div>')}document.getElementsByClassName("sticky_layout")[0]&&(location.pathname,1)&&electric_clock_injector_config()</script><script src="https://moyand.gitee.io/api/jquery.min.js"></script><script>loc=$.ajax({url:"https://ipapi.co/json/",type:"GET",dataType:"json",async:!1,success:function(e){}}),ip=$.parseJSON(loc.responseText).ip,version=$.parseJSON(loc.responseText).version,city=$.parseJSON(loc.responseText).city,country=$.parseJSON(loc.responseText).country_name</script><script data-pjax src="https://moyand.gitee.io/api/npm/hexo-electric-clock-plus/clock.js"></script></body></html>